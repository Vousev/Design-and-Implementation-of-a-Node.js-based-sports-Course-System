<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>体育选课系统 - 管理员端</title>
    
    <!-- ElementUI CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    
    <!-- 自定义CSS -->
    <link rel="stylesheet" href="/css/admin.css">
    
    <!-- 图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <!-- 身份验证检查中 -->
        <div v-if="isCheckingAuth" class="auth-check-container">
            <div class="auth-check-content">
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
                <h3>正在验证身份...</h3>
                <p>请稍候，系统正在验证您的登录状态</p>
            </div>
        </div>

        <!-- 登录页面 -->
        <div v-else-if="!isLoggedIn" class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <h2><i class="fas fa-shield-alt"></i> 管理员登录</h2>
                    <p>体育选课系统管理平台</p>
                </div>
                
                <el-form :model="loginForm" :rules="loginRules" ref="loginForm" class="login-form">
                    <el-form-item prop="username">
                        <el-input
                            v-model="loginForm.username"
                            placeholder="管理员用户名"
                            prefix-icon="el-icon-user"
                            size="large">
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item prop="password">
                        <el-input
                            v-model="loginForm.password"
                            type="password"
                            placeholder="密码"
                            prefix-icon="el-icon-lock"
                            size="large"
                            @keyup.enter.native="handleLogin">
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item>
                        <el-button
                            type="primary"
                            size="large"
                            :loading="loginLoading"
                            @click="handleLogin"
                            class="login-btn">
                            <i class="fas fa-sign-in-alt"></i> 登录
                        </el-button>
                    </el-form-item>
                </el-form>
            </div>
        </div>

        <!-- 主界面 -->
        <div v-else class="admin-container">
            <!-- 顶部导航栏 -->
            <div class="main-header">
                <div class="header-content">
                    <div class="logo">
                        <h2><i class="fas fa-cogs"></i> 管理员控制台</h2>
                    </div>
                    
                    <div class="header-actions">
                        <!-- 系统状态指示器 -->
                        <div class="system-status" :class="systemHealth.overall_status">
                            <i :class="getHealthIcon(systemHealth.overall_status)"></i>
                            <span>{{ getHealthText(systemHealth.overall_status) }}</span>
                        </div>
                        
                        <!-- 用户信息 -->
                        <el-dropdown @command="handleUserCommand">
                            <span class="user-dropdown">
                                <i class="fas fa-user-shield"></i>
                                {{ currentUser.real_name || currentUser.username }}
                                <i class="el-icon-arrow-down"></i>
                            </span>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item command="profile">
                                    <i class="fas fa-user"></i> 个人信息
                                </el-dropdown-item>
                                <el-dropdown-item command="changePassword">
                                    <i class="fas fa-key"></i> 修改密码
                                </el-dropdown-item>
                                <el-dropdown-item divided command="logout">
                                    <i class="fas fa-sign-out-alt"></i> 退出登录
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                </div>
            </div>

            <!-- 主容器 -->
            <el-container class="main-container">
                <!-- 侧边栏 -->
                <el-aside width="250px" class="sidebar">
                    <el-menu
                        :default-active="activeMenu"
                        class="sidebar-menu"
                        background-color="#304156"
                        text-color="#bfcbd9"
                        active-text-color="#409EFF"
                        @select="handleMenuSelect">
                        
                        <!-- 系统概览 -->
                        <el-menu-item index="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>系统概览</span>
                        </el-menu-item>

                        <!-- 选课配置 -->
                        <el-submenu index="config">
                            <template slot="title">
                                <i class="fas fa-cog"></i>
                                <span>选课配置</span>
                            </template>
                            <el-menu-item index="selection-config">选课时间配置</el-menu-item>
                            <el-menu-item index="system-config">系统参数配置</el-menu-item>
                        </el-submenu>

                        <!-- 资源管理 -->
                        <el-submenu index="resources">
                            <template slot="title">
                                <i class="fas fa-building"></i>
                                <span>资源管理</span>
                            </template>
                            <el-menu-item index="venues">场地管理</el-menu-item>
                            <el-menu-item index="teachers">教师管理</el-menu-item>
                        </el-submenu>

                        <!-- 监控统计 -->
                        <el-submenu index="monitoring">
                            <template slot="title">
                                <i class="fas fa-chart-line"></i>
                                <span>监控统计</span>
                                <el-badge v-if="pendingIncidents > 0" :value="pendingIncidents" class="badge"></el-badge>
                            </template>
                            <el-menu-item index="real-time">实时监控</el-menu-item>
                            <el-menu-item index="statistics">选课统计</el-menu-item>
                            <el-menu-item index="popularity">课程热度</el-menu-item>
                            <el-menu-item index="performance">系统性能</el-menu-item>
                        </el-submenu>

                        <!-- 异常处理 -->
                        <el-submenu index="emergency">
                            <template slot="title">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>异常处理</span>
                                <el-badge v-if="pendingIncidents > 0" :value="pendingIncidents" class="badge"></el-badge>
                            </template>
                            <el-menu-item index="incidents">异常事件</el-menu-item>
                            <el-menu-item index="manual-adjust">手动调整</el-menu-item>
                            <el-menu-item index="maintenance">系统维护</el-menu-item>
                        </el-submenu>

                        <!-- 用户管理 -->
                        <el-submenu index="users" v-if="hasPermission(['user_management'])">
                            <template slot="title">
                                <i class="fas fa-users"></i>
                                <span>用户管理</span>
                            </template>
                            <el-menu-item index="students">学生管理</el-menu-item>
                            <el-menu-item index="admins">管理员管理</el-menu-item>
                        </el-submenu>

                        <!-- 系统日志 -->
                        <el-menu-item index="logs" v-if="hasPermission(['system_monitoring'])">
                            <i class="fas fa-file-alt"></i>
                            <span>系统日志</span>
                        </el-menu-item>
                    </el-menu>
                </el-aside>

                <!-- 主内容区域 -->
                <el-main class="main-content">
                    <!-- 系统概览 -->
                    <div v-show="activeMenu === 'dashboard'" class="dashboard">
                        <div class="page-header">
                            <h3>系统概览</h3>
                            <el-button @click="refreshOverview" icon="el-icon-refresh">刷新数据</el-button>
                        </div>

                        <!-- 统计卡片 -->
                        <el-row :gutter="20" class="stats-row">
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card gradient-blue" shadow="hover">
                                    <div class="stat-content">
                                        <div class="stat-info">
                                            <div class="stat-number">{{ overview.users?.total_users || 0 }}</div>
                                            <div class="stat-label">总用户数</div>
                                            <div class="stat-trend" v-if="overview.users?.trend">
                                                <i :class="getTrendIcon(overview.users.trend)" :style="getTrendColor(overview.users.trend)"></i>
                                                <span class="trend-text">{{ getTrendText(overview.users.trend) }}</span>
                                            </div>
                                        </div>
                                        <div class="stat-icon-wrapper">
                                            <i class="fas fa-users stat-icon"></i>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card gradient-green" shadow="hover">
                                    <div class="stat-content">
                                        <div class="stat-info">
                                            <div class="stat-number">{{ overview.courses?.published_courses || 0 }}</div>
                                            <div class="stat-label">已发布课程</div>
                                            <div class="stat-sub-info">
                                                <span>活跃: {{ overview.courses?.active_courses || 0 }}</span>
                                            </div>
                                        </div>
                                        <div class="stat-icon-wrapper">
                                            <i class="fas fa-book stat-icon"></i>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card gradient-purple" shadow="hover">
                                    <div class="stat-content">
                                        <div class="stat-info">
                                            <div class="stat-number">{{ overview.selections?.successful_selections || 0 }}</div>
                                            <div class="stat-label">成功选课数</div>
                                            <div class="stat-sub-info">
                                                <span>选课率: {{ getSelectionRate() }}%</span>
                                            </div>
                                        </div>
                                        <div class="stat-icon-wrapper">
                                            <i class="fas fa-check-circle stat-icon"></i>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card gradient-orange" shadow="hover">
                                    <div class="stat-content">
                                        <div class="stat-info">
                                            <div class="stat-number">{{ overview.venues?.active_venues || 0 }}</div>
                                            <div class="stat-label">可用场地数</div>
                                            <div class="stat-sub-info">
                                                <span>利用率: {{ getVenueUtilization() }}%</span>
                                            </div>
                                        </div>
                                        <div class="stat-icon-wrapper">
                                            <i class="fas fa-building stat-icon"></i>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>


                        <!-- 当前选课配置 -->
                        <el-card class="current-config-card" v-if="overview.currentConfig">
                            <div slot="header">
                                <span><i class="fas fa-clock"></i> 当前选课配置</span>
                                <el-tag :type="getConfigStatusType(overview.currentConfig.status)">
                                    {{ getConfigStatusText(overview.currentConfig.status) }}
                                </el-tag>
                            </div>
                            <div class="config-info">
                                <p><strong>{{ overview.currentConfig.academic_year }}学年 {{ overview.currentConfig.semester }}学期 - {{ overview.currentConfig.round_name }}</strong></p>
                                <p>选课方式: {{ getSelectionMethodText(overview.currentConfig.selection_method) }}</p>
                                <p>时间: {{ formatDateTime(overview.currentConfig.start_time) }} - {{ formatDateTime(overview.currentConfig.end_time) }}</p>
                                <p>学分限制: {{ overview.currentConfig.max_credits }}学分 | 课程限制: {{ overview.currentConfig.max_courses }}门</p>
                            </div>
                        </el-card>

                        <!-- 实时活动 -->
                        <el-card class="recent-activities">
                            <div slot="header">
                                <span><i class="fas fa-activity"></i> 实时活动</span>
                            </div>
                            <div v-if="realtimeData.isActive">
                                <p>最近5分钟选课活动: 总计 {{ realtimeData.recentActivity?.total_attempts || 0 }} 次尝试，成功 {{ realtimeData.recentActivity?.successful_attempts || 0 }} 次</p>
                                <div v-if="realtimeData.hotCourses && realtimeData.hotCourses.length > 0">
                                    <h4>热门课程</h4>
                                    <el-table :data="realtimeData.hotCourses.slice(0, 5)" size="small">
                                        <el-table-column prop="name" label="课程名称"></el-table-column>
                                        <el-table-column prop="selected_count" label="已选人数" width="100"></el-table-column>
                                        <el-table-column prop="waiting_count" label="候补人数" width="100"></el-table-column>
                                        <el-table-column prop="recent_attempts" label="近期尝试" width="100"></el-table-column>
                                    </el-table>
                                </div>
                            </div>
                            <div v-else class="no-activity">
                                <i class="fas fa-pause-circle"></i>
                                <p>当前没有激活的选课配置</p>
                            </div>
                        </el-card>
                    </div>

                    <!-- 选课时间配置 -->
                    <div v-show="activeMenu === 'selection-config'" class="selection-config">
                        <div class="page-header">
                            <h3>选课时间配置</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showConfigDialog('create')" icon="el-icon-plus">
                                    新建配置
                                </el-button>
                                <el-button @click="refreshConfigs" icon="el-icon-refresh">刷新</el-button>
                            </div>
                        </div>

                        <!-- 搜索筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="configFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="学年">
                                    <el-select v-model="configFilters.academic_year" placeholder="选择学年" clearable style="width: 140px;">
                                        <el-option label="2025-2026" value="2025-2026"></el-option>
                                        <el-option label="2024-2025" value="2024-2025"></el-option>
                                        <el-option label="2023-2024" value="2023-2024"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="学期">
                                    <el-select v-model="configFilters.semester" placeholder="选择学期" clearable style="width: 130px;">
                                        <el-option label="春季学期" value="2026春"></el-option>
                                        <el-option label="秋季学期" value="2025秋"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="状态">
                                    <el-select v-model="configFilters.status" placeholder="选择状态" clearable style="width: 120px;">
                                        <el-option label="草稿" value="draft"></el-option>
                                        <el-option label="激活" value="active"></el-option>
                                        <el-option label="已结束" value="ended"></el-option>
                                        <el-option label="已取消" value="cancelled"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchConfigs">搜索</el-button>
                                    <el-button @click="resetConfigFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 配置列表 -->
                        <el-card class="table-card">
                            <el-table :data="configList" v-loading="configLoading" style="width: 100%" :show-overflow-tooltip="false">
                                <el-table-column prop="academic_year" label="学年" min-width="100" align="center"></el-table-column>
                                <el-table-column prop="semester" label="学期" min-width="80" align="center"></el-table-column>
                                <el-table-column prop="round_number" label="轮次" min-width="60" align="center"></el-table-column>
                                <el-table-column prop="round_name" label="轮次名称" min-width="120" align="center"></el-table-column>
                                <el-table-column prop="selection_method" label="选课方式" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getSelectionMethodType(scope.row.selection_method)">
                                            {{ getSelectionMethodText(scope.row.selection_method) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="选课时间" min-width="200" align="center">
                                    <template slot-scope="scope">
                                        <div style="line-height: 1.4;">
                                            <div style="font-size: 12px; color: #666;">
                                                <i class="el-icon-time"></i> {{ formatDateTime(scope.row.start_time) }}
                                            </div>
                                            <div style="font-size: 12px; color: #666; margin-top: 2px;">
                                                <i class="el-icon-time"></i> {{ formatDateTime(scope.row.end_time) }}
                                            </div>
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="status" label="状态" min-width="80" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getConfigStatusType(scope.row.status)">
                                            {{ getConfigStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="creator_name" label="创建者" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column label="操作" min-width="260" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewConfig(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="editConfig(scope.row)" v-if="scope.row.status === 'draft'">编辑</el-button>
                                            <el-button size="mini" type="success" @click="activateConfig(scope.row)" v-if="scope.row.status === 'draft'">激活</el-button>
                                            <el-button size="mini" type="warning" @click="endConfig(scope.row)" v-if="scope.row.status === 'active'">结束</el-button>
                                            <el-dropdown @command="handleConfigCommand" v-if="scope.row.status === 'draft'">
                                                <el-button size="mini">
                                                    更多<i class="el-icon-arrow-down"></i>
                                                </el-button>
                                                <el-dropdown-menu slot="dropdown">
                                                    <el-dropdown-item :command="{action: 'copy', row: scope.row}">复制</el-dropdown-item>
                                                    <el-dropdown-item :command="{action: 'delete', row: scope.row}" divided>删除</el-dropdown-item>
                                                </el-dropdown-menu>
                                            </el-dropdown>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleConfigSizeChange"
                                    @current-change="handleConfigCurrentChange"
                                    :current-page="configPagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="configPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="configPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 场地管理 -->
                    <div v-show="activeMenu === 'venues'" class="venues-management">
                        <div class="page-header">
                            <h3>场地管理</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showVenueDialog('create')" icon="el-icon-plus">
                                    新建场地
                                </el-button>
                                <el-button @click="refreshVenues" icon="el-icon-refresh">刷新</el-button>
                            </div>
                        </div>

                        <!-- 搜索筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="venueFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="关键词">
                                    <el-input v-model="venueFilters.keyword" placeholder="场地名称或位置" clearable style="width: 180px;"></el-input>
                                </el-form-item>
                                <el-form-item label="类型">
                                    <el-select v-model="venueFilters.type" placeholder="场地类型" clearable style="width: 120px;">
                                        <el-option label="室内" value="indoor"></el-option>
                                        <el-option label="室外" value="outdoor"></el-option>
                                        <el-option label="游泳馆" value="swimming"></el-option>
                                        <el-option label="健身房" value="gym"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="状态">
                                    <el-select v-model="venueFilters.status" placeholder="场地状态" clearable style="width: 120px;">
                                        <el-option label="可用" value="available"></el-option>
                                        <el-option label="维护中" value="maintenance"></el-option>
                                        <el-option label="不可用" value="unavailable"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchVenues">搜索</el-button>
                                    <el-button @click="resetVenueFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 场地列表 -->
                        <el-card class="table-card">
                            <el-table :data="venueList" v-loading="venueLoading" style="width: 100%">
                                <el-table-column prop="name" label="场地名称" min-width="120" align="center"></el-table-column>
                                <el-table-column prop="type" label="类型" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getVenueTypeColor(scope.row.type)">
                                            {{ getVenueTypeText(scope.row.type) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="location" label="位置" min-width="150" align="center"></el-table-column>
                                <el-table-column prop="capacity" label="容量" min-width="80" align="center"></el-table-column>
                                <el-table-column prop="status" label="状态" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getVenueStatusColor(scope.row.status)">
                                            {{ getVenueStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="available_slots" label="可用时段" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column label="设备" min-width="180" class-name="hide-on-mobile">
                                    <template slot-scope="scope">
                                        <div class="equipment-display">
                                            <el-tooltip 
                                                v-if="scope.row.equipment" 
                                                :content="scope.row.equipment" 
                                                placement="top"
                                                effect="dark">
                                                <span class="equipment-text">
                                                    <i class="el-icon-s-tools"></i>
                                                    {{ formatEquipment(scope.row.equipment) }}
                                                </span>
                                            </el-tooltip>
                                            <span v-else class="no-equipment">
                                                <i class="el-icon-minus"></i>
                                                暂无设备
                                            </span>
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="240" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewVenue(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="editVenue(scope.row)">编辑</el-button>
                                            <el-button size="mini" type="warning" @click="manageVenueSchedule(scope.row)">时间表</el-button>
                                            <el-button size="mini" type="danger" @click="deleteVenue(scope.row)">删除</el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleVenueSizeChange"
                                    @current-change="handleVenueCurrentChange"
                                    :current-page="venuePagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="venuePagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="venuePagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 教师管理 -->
                    <div v-show="activeMenu === 'teachers'" class="teachers-management">
                        <div class="page-header">
                            <h3>教师管理</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showTeacherDialog('create')" icon="el-icon-plus">
                                    新建教师
                                </el-button>
                                <el-button @click="refreshTeachers" icon="el-icon-refresh">刷新</el-button>
                            </div>
                        </div>

                        <!-- 搜索筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="teacherFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="关键词">
                                    <el-input v-model="teacherFilters.keyword" placeholder="姓名、工号或邮箱" clearable style="width: 180px;"></el-input>
                                </el-form-item>
                                <el-form-item label="部门">
                                    <el-select v-model="teacherFilters.department" placeholder="所属部门" clearable style="width: 130px;">
                                        <el-option label="体育学院" value="体育学院"></el-option>
                                        <el-option label="教务处" value="教务处"></el-option>
                                        <el-option label="学生处" value="学生处"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="状态">
                                    <el-select v-model="teacherFilters.status" placeholder="教师状态" clearable style="width: 120px;">
                                        <el-option label="在职" value="active"></el-option>
                                        <el-option label="离职" value="inactive"></el-option>
                                        <el-option label="暂停" value="suspended"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchTeachers">搜索</el-button>
                                    <el-button @click="resetTeacherFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 教师列表 -->
                        <el-card class="table-card">
                            <el-table :data="teacherList" v-loading="teacherLoading" style="width: 100%">
                                <el-table-column prop="name" label="姓名" min-width="100" align="center"></el-table-column>
                                <el-table-column label="工号" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        {{ scope.row.employee_id || scope.row.teacher_id || '-' }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="title" label="职称" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="department" label="部门" min-width="120" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="phone" label="联系电话" min-width="120" align="center"></el-table-column>
                                <el-table-column prop="email" label="邮箱" min-width="150" align="center" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="course_count" label="课程数" min-width="80" align="center"></el-table-column>
                                <el-table-column prop="status" label="状态" min-width="80" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getTeacherStatusColor(scope.row.status)">
                                            {{ getTeacherStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="260" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewTeacher(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="editTeacher(scope.row)">编辑</el-button>
                                            <el-button size="mini" type="warning" @click="manageTeacherQualifications(scope.row)">资质</el-button>
                                            <el-button size="mini" type="danger" @click="deleteTeacher(scope.row)">删除</el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleTeacherSizeChange"
                                    @current-change="handleTeacherCurrentChange"
                                    :current-page="teacherPagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="teacherPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="teacherPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 实时监控 -->
                    <div v-show="activeMenu === 'real-time'" class="real-time-monitoring">
                        <div class="page-header">
                            <h3>实时监控</h3>
                            <div class="header-actions">
                                <el-button @click="refreshRealTimeData" icon="el-icon-refresh" :loading="realTimeLoading">
                                    刷新数据
                                </el-button>
                                <el-switch
                                    v-model="autoRefresh"
                                    @change="toggleAutoRefresh"
                                    active-text="自动刷新"
                                    inactive-text="手动刷新">
                                </el-switch>
                            </div>
                        </div>

                        <!-- 实时状态卡片 -->
                        <el-row :gutter="20" class="stats-row">
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card realtime-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ realTimeData.recentActivity?.total_attempts || 0 }}</div>
                                            <div class="stat-label">5分钟内选课尝试</div>
                                        </div>
                                        <i class="fas fa-mouse-pointer stat-icon"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card realtime-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ realTimeData.recentActivity?.successful_attempts || 0 }}</div>
                                            <div class="stat-label">成功选课数</div>
                                        </div>
                                        <i class="fas fa-check-circle stat-icon success"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card realtime-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ realTimeData.recentActivity?.waiting_attempts || 0 }}</div>
                                            <div class="stat-label">候补人数</div>
                                        </div>
                                        <i class="fas fa-clock stat-icon warning"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :xs="24" :sm="12" :md="6" :lg="6" :xl="6">
                                <el-card class="stat-card realtime-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ getOnlineUsers() }}</div>
                                            <div class="stat-label">在线用户</div>
                                        </div>
                                        <i class="fas fa-users stat-icon info"></i>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <!-- 热门课程 -->
                        <el-card class="hot-courses-card">
                            <div slot="header">
                                <span><i class="fas fa-fire"></i> 热门课程（实时）</span>
                            </div>
                            <el-table :data="realTimeData.hotCourses || []" size="small" style="width: 100%">
                                <el-table-column prop="name" label="课程名称" min-width="150" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="selected_count" label="已选人数" width="100" align="center"></el-table-column>
                                <el-table-column prop="waiting_count" label="候补人数" width="100" align="center"></el-table-column>
                                <el-table-column prop="recent_attempts" label="近期尝试" width="100" align="center"></el-table-column>
                                <el-table-column prop="capacity" label="总容量" width="100" align="center"></el-table-column>
                                <el-table-column label="选课率" width="140" align="center">
                                    <template slot-scope="scope">
                                        <el-progress 
                                            :percentage="Math.round((scope.row.selected_count / scope.row.capacity) * 100)" 
                                            :stroke-width="8"
                                            :color="getProgressColor(scope.row.selected_count / scope.row.capacity)">
                                        </el-progress>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </el-card>
                    </div>

                    <!-- 选课统计 -->
                    <div v-show="activeMenu === 'statistics'" class="selection-statistics">
                        <div class="page-header">
                            <h3>选课统计</h3>
                            <div class="header-actions">
                                <el-button @click="refreshStatistics" icon="el-icon-refresh" :loading="statisticsLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 统计筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="statisticsFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="学年">
                                    <el-select v-model="statisticsFilters.academic_year" placeholder="选择学年" clearable style="width: 140px;">
                                        <el-option label="2025-2026" value="2025-2026"></el-option>
                                        <el-option label="2024-2025" value="2024-2025"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="学期">
                                    <el-select v-model="statisticsFilters.semester" placeholder="选择学期" clearable style="width: 130px;">
                                        <el-option label="春季学期" value="2026春"></el-option>
                                        <el-option label="秋季学期" value="2025秋"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="loadStatistics">查询</el-button>
                                    <el-button @click="resetStatisticsFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 统计图表 -->
                        <el-row :gutter="20">
                            <el-col :span="12">
                                <el-card class="chart-card">
                                    <div slot="header">
                                        <span><i class="fas fa-chart-pie"></i> 选课成功率趋势</span>
                                    </div>
                                    <div class="chart-container">
                                        <div class="chart-placeholder">
                                            <i class="fas fa-chart-line"></i>
                                            <p>图表功能需要集成Chart.js</p>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="12">
                                <el-card class="chart-card">
                                    <div slot="header">
                                        <span><i class="fas fa-chart-bar"></i> 选课时间分布</span>
                                    </div>
                                    <div class="chart-container">
                                        <div class="chart-placeholder">
                                            <i class="fas fa-chart-area"></i>
                                            <p>图表功能需要集成Chart.js</p>
                                        </div>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <!-- 统计数据表格 -->
                        <el-card class="table-card">
                            <div slot="header">
                                <span><i class="fas fa-table"></i> 详细统计数据</span>
                            </div>
                            <el-table :data="statisticsData.courseProgress || []" v-loading="statisticsLoading">
                                <el-table-column prop="name" label="课程名称"></el-table-column>
                                <el-table-column prop="teacher_name" label="教师"></el-table-column>
                                <el-table-column prop="venue_name" label="场地"></el-table-column>
                                <el-table-column prop="capacity" label="容量"></el-table-column>
                                <el-table-column prop="selected_count" label="已选"></el-table-column>
                                <el-table-column prop="waiting_count" label="候补"></el-table-column>
                                <el-table-column label="填充率" width="150">
                                    <template slot-scope="scope">
                                        <el-progress 
                                            :percentage="scope.row.fill_rate || 0" 
                                            :stroke-width="8">
                                        </el-progress>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </el-card>
                    </div>

                    <!-- 课程热度 -->
                    <div v-show="activeMenu === 'popularity'" class="course-popularity">
                        <div class="page-header">
                            <h3>课程热度分析</h3>
                            <div class="header-actions">
                                <el-button @click="refreshPopularity" icon="el-icon-refresh" :loading="popularityLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 热度筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="popularityFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="类别">
                                    <el-select v-model="popularityFilters.category" placeholder="选择类别" clearable style="width: 140px;">
                                        <el-option label="球类运动" value="球类运动"></el-option>
                                        <el-option label="田径运动" value="田径运动"></el-option>
                                        <el-option label="武术运动" value="武术运动"></el-option>
                                        <el-option label="游泳运动" value="游泳运动"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="loadPopularity">查询</el-button>
                                    <el-button @click="resetPopularityFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 热度排行 -->
                        <el-card class="table-card">
                            <div slot="header">
                                <span><i class="fas fa-trophy"></i> 课程热度排行</span>
                            </div>
                            <el-table :data="popularityData.list || []" v-loading="popularityLoading">
                                <el-table-column label="排名" width="80">
                                    <template slot-scope="scope">
                                        <span class="rank-number" :class="getRankClass(scope.$index)">
                                            {{ scope.$index + 1 }}
                                        </span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="course_name" label="课程名称"></el-table-column>
                                <el-table-column prop="teacher_name" label="教师"></el-table-column>
                                <el-table-column prop="category" label="类别"></el-table-column>
                                <el-table-column prop="popularity_score" label="热度分数" width="120">
                                    <template slot-scope="scope">
                                        <el-tag :type="getPopularityScoreType(scope.row.popularity_score)">
                                            {{ scope.row.popularity_score }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="view_count" label="浏览次数" width="100"></el-table-column>
                                <el-table-column prop="successful_selections" label="成功选课" width="100"></el-table-column>
                                <el-table-column prop="success_rate" label="成功率" width="100">
                                    <template slot-scope="scope">
                                        {{ scope.row.success_rate }}%
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handlePopularitySizeChange"
                                    @current-change="handlePopularityCurrentChange"
                                    :current-page="popularityPagination.page"
                                    :page-sizes="[10, 20, 50]"
                                    :page-size="popularityPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="popularityPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 系统性能 -->
                    <div v-show="activeMenu === 'performance'" class="system-performance">
                        <div class="page-header">
                            <h3>系统性能监控</h3>
                            <div class="header-actions">
                                <el-select v-model="performancePeriod" @change="loadPerformance" size="small">
                                    <el-option label="最近1小时" value="1h"></el-option>
                                    <el-option label="最近24小时" value="24h"></el-option>
                                    <el-option label="最近7天" value="7d"></el-option>
                                    <el-option label="最近30天" value="30d"></el-option>
                                </el-select>
                                <el-button @click="loadPerformance" icon="el-icon-refresh" :loading="performanceLoading">
                                    刷新
                                </el-button>
                            </div>
                        </div>

                        <!-- 性能指标 -->
                        <el-row :gutter="20" class="stats-row">
                            <el-col :span="8">
                                <el-card class="stat-card performance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ performanceData.currentStatus?.concurrent_users || 0 }}</div>
                                            <div class="stat-label">当前并发用户</div>
                                        </div>
                                        <i class="fas fa-users stat-icon"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="8">
                                <el-card class="stat-card performance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ performanceData.currentStatus?.response_time || 0 }}ms</div>
                                            <div class="stat-label">平均响应时间</div>
                                        </div>
                                        <i class="fas fa-tachometer-alt stat-icon"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="8">
                                <el-card class="stat-card performance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-number">{{ (performanceData.currentStatus?.system_load || 0).toFixed(2) }}</div>
                                            <div class="stat-label">系统负载</div>
                                        </div>
                                        <i class="fas fa-server stat-icon"></i>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <!-- 性能图表 -->
                        <el-card class="chart-card">
                            <div slot="header">
                                <span><i class="fas fa-chart-line"></i> 性能趋势图</span>
                            </div>
                            <div class="chart-container">
                                <div class="chart-placeholder">
                                    <i class="fas fa-chart-line"></i>
                                    <p>性能监控图表功能需要集成Chart.js</p>
                                    <p>显示并发用户数、响应时间、系统负载等指标的时间序列图</p>
                                </div>
                            </div>
                        </el-card>
                    </div>

                    <!-- 异常事件 -->
                    <div v-show="activeMenu === 'incidents'" class="incidents-management">
                        <div class="page-header">
                            <h3>异常事件管理</h3>
                            <div class="header-actions">
                                <el-button type="danger" @click="showCreateIncidentDialog" icon="el-icon-warning">
                                    创建异常事件
                                </el-button>
                                <el-button @click="loadIncidents" icon="el-icon-refresh" :loading="incidentsLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 异常事件列表 -->
                        <el-card class="table-card">
                            <el-table :data="incidentsList" v-loading="incidentsLoading" style="width: 100%">
                                <el-table-column prop="incident_type" label="事件类型" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getIncidentTypeColor(scope.row.incident_type)">
                                            {{ getIncidentTypeText(scope.row.incident_type) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="severity" label="严重程度" min-width="90" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getSeverityColor(scope.row.severity)">
                                            {{ getSeverityText(scope.row.severity) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="title" label="事件标题" min-width="150" align="center" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="description" label="描述" min-width="160" align="center" show-overflow-tooltip class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="resolution_status" label="状态" min-width="80" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getResolutionStatusColor(scope.row.resolution_status)">
                                            {{ getResolutionStatusText(scope.row.resolution_status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="assigned_to_name" label="负责人" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="created_at" label="创建时间" min-width="140" align="center">
                                    <template slot-scope="scope">
                                        <div style="font-size: 12px;">
                                            {{ formatDateTime(scope.row.created_at) }}
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="160" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewIncident(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="updateIncidentStatus(scope.row)" v-if="scope.row.resolution_status !== 'resolved'">
                                                处理
                                            </el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleIncidentsSizeChange"
                                    @current-change="handleIncidentsCurrentChange"
                                    :current-page="incidentsPagination.page"
                                    :page-sizes="[10, 20, 50]"
                                    :page-size="incidentsPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="incidentsPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 手动调整 -->
                    <div v-show="activeMenu === 'manual-adjust'" class="manual-adjust">
                        <div class="page-header">
                            <h3>手动调整选课</h3>
                            <div class="header-actions">
                                <el-button type="warning" @click="showBatchAdjustDialog" icon="el-icon-edit">
                                    批量调整
                                </el-button>
                            </div>
                        </div>

                        <!-- 手动调整表单 -->
                        <el-card class="adjust-form-card">
                            <div slot="header">
                                <span><i class="fas fa-tools"></i> 单个调整</span>
                            </div>
                            
                            <el-form :model="adjustForm" :rules="adjustRules" ref="adjustForm" label-width="120px">
                                <el-row :gutter="20">
                                    <el-col :span="12">
                                        <el-form-item label="学生学号" prop="student_id">
                                            <el-input v-model="adjustForm.student_id" placeholder="请输入学生学号" @blur="loadStudentInfo"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span="12">
                                        <el-form-item label="课程代码" prop="course_code">
                                            <el-input v-model="adjustForm.course_code" placeholder="请输入课程代码" @blur="loadCourseInfo"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-row>

                                <!-- 学生信息展示 -->
                                <el-row v-if="adjustForm.student_info" :gutter="20">
                                    <el-col :span="24">
                                        <el-alert :title="`学生信息: ${adjustForm.student_info.real_name} (${adjustForm.student_info.student_id}) - ${adjustForm.student_info.major} ${adjustForm.student_info.class_name}`" 
                                                  type="info" :closable="false" show-icon>
                                        </el-alert>
                                    </el-col>
                                </el-row>

                                <!-- 课程信息展示 -->
                                <el-row v-if="adjustForm.course_info" :gutter="20" style="margin-top: 10px;">
                                    <el-col :span="24">
                                        <el-alert :title="`课程信息: ${adjustForm.course_info.name} (${adjustForm.course_info.course_code}) - 已选 ${adjustForm.course_info.enrolled_count}/${adjustForm.course_info.capacity}`"
                                                  type="success" :closable="false" show-icon>
                                        </el-alert>
                                    </el-col>
                                </el-row>

                                <el-form-item label="调整操作" prop="action">
                                    <el-select v-model="adjustForm.action" placeholder="选择调整操作">
                                        <el-option label="强制选课" value="force_select"></el-option>
                                        <el-option label="强制退课" value="force_drop"></el-option>
                                        <el-option label="移至候补" value="move_to_waiting"></el-option>
                                        <el-option label="移除候补" value="remove_from_waiting"></el-option>
                                    </el-select>
                                </el-form-item>

                                <el-form-item label="调整原因" prop="reason">
                                    <el-input v-model="adjustForm.reason" type="textarea" :rows="3" placeholder="请详细说明调整原因"></el-input>
                                </el-form-item>

                                <el-form-item>
                                    <el-button type="primary" @click="submitAdjustment" :loading="adjustLoading">
                                        <i class="fas fa-save"></i> 执行调整
                                    </el-button>
                                    <el-button @click="resetAdjustForm">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>
                    </div>

                    <!-- 系统维护 -->
                    <div v-show="activeMenu === 'maintenance'" class="system-maintenance">
                        <div class="page-header">
                            <h3>系统维护</h3>
                            <div class="header-actions">
                                <el-button :type="maintenanceMode.enabled ? 'success' : 'danger'" 
                                          @click="toggleMaintenanceMode" 
                                          :loading="maintenanceLoading">
                                    <i :class="maintenanceMode.enabled ? 'fas fa-play' : 'fas fa-pause'"></i>
                                    {{ maintenanceMode.enabled ? '退出维护模式' : '进入维护模式' }}
                                </el-button>
                            </div>
                        </div>

                        <!-- 系统状态 -->
                        <el-row :gutter="20" class="stats-row">
                            <el-col :span="6">
                                <el-card class="stat-card maintenance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-label">维护状态</div>
                                            <div :class="['stat-status', maintenanceMode.enabled ? 'maintenance' : 'normal']">
                                                {{ maintenanceMode.enabled ? '维护中' : '正常运行' }}
                                            </div>
                                        </div>
                                        <i :class="maintenanceMode.enabled ? 'fas fa-wrench stat-icon warning' : 'fas fa-check stat-icon success'"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card maintenance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-label">系统健康度</div>
                                            <div :class="['stat-status', systemHealth.overall_status]">
                                                {{ getHealthText(systemHealth.overall_status) }}
                                            </div>
                                        </div>
                                        <i :class="getHealthIcon(systemHealth.overall_status) + ' stat-icon'"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card maintenance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-label">数据库状态</div>
                                            <div class="stat-status healthy">
                                                连接正常
                                            </div>
                                        </div>
                                        <i class="fas fa-database stat-icon success"></i>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card maintenance-card" shadow="hover">
                                    <div class="stat-content">
                                        <div>
                                            <div class="stat-label">待处理事件</div>
                                            <div class="stat-number">{{ pendingIncidents }}</div>
                                        </div>
                                        <i class="fas fa-exclamation-triangle stat-icon warning"></i>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <!-- 维护操作 -->
                        <el-card class="maintenance-operations">
                            <div slot="header">
                                <span><i class="fas fa-cogs"></i> 系统维护操作</span>
                            </div>
                            
                            <el-row :gutter="20">
                                <el-col :span="12">
                                    <el-card class="operation-card">
                                        <div class="operation-header">
                                            <i class="fas fa-stop-circle"></i>
                                            <h4>紧急停止选课</h4>
                                        </div>
                                        <p>立即停止所有选课活动，用于紧急情况处理</p>
                                        <el-button type="danger" @click="showEmergencyStopDialog" :disabled="maintenanceMode.enabled">
                                            紧急停止
                                        </el-button>
                                    </el-card>
                                </el-col>
                                <el-col :span="12">
                                    <el-card class="operation-card">
                                        <div class="operation-header">
                                            <i class="fas fa-broom"></i>
                                            <h4>数据清理</h4>
                                        </div>
                                        <p>清理系统中的异常数据和冗余记录</p>
                                        <el-button type="warning" @click="showDataCleanupDialog">
                                            数据清理
                                        </el-button>
                                    </el-card>
                                </el-col>
                            </el-row>

                            <!-- 数据完整性验证 -->
                            <div style="margin-top: 20px;">
                                <h4><i class="fas fa-check-circle"></i> 数据完整性验证</h4>
                                <el-row :gutter="20">
                                    <el-col :span="12">
                                        <el-card class="operation-card">
                                            <div class="operation-header">
                                                <i class="fas fa-database"></i>
                                                <h4>数据关联状态</h4>
                                            </div>
                                            <div v-loading="dataValidationLoading">
                                                <div v-if="dataRelationStatus" class="relation-status">
                                                    <div class="status-indicator">
                                                        <el-tag 
                                                            :type="getDataStatusType(dataRelationStatus.overall_status)" 
                                                            size="medium">
                                                            {{ getDataStatusText(dataRelationStatus.overall_status) }}
                                                        </el-tag>
                                                    </div>
                                                    <div class="status-summary" style="margin-top: 10px; font-size: 12px;">
                                                        <p><i class="el-icon-success" style="color: #67c23a;"></i> 正常: {{ dataRelationStatus.summary.healthy }}</p>
                                                        <p><i class="el-icon-warning" style="color: #e6a23c;"></i> 警告: {{ dataRelationStatus.summary.warnings }}</p>
                                                        <p><i class="el-icon-error" style="color: #f56c6c;"></i> 错误: {{ dataRelationStatus.summary.errors }}</p>
                                                    </div>
                                                    <div style="margin-top: 10px;">
                                                        <el-button size="small" @click="loadDataRelationStatus">刷新状态</el-button>
                                                        <el-button size="small" type="primary" @click="viewDataRelationDetails">查看详情</el-button>
                                                    </div>
                                                </div>
                                                <div v-else>
                                                    <p style="color: #999; text-align: center; margin: 20px 0;">暂未加载数据关联状态</p>
                                                    <el-button size="small" @click="loadDataRelationStatus">获取状态</el-button>
                                                </div>
                                            </div>
                                        </el-card>
                                    </el-col>
                                    <el-col :span="12">
                                        <el-card class="operation-card">
                                            <div class="operation-header">
                                                <i class="fas fa-shield-alt"></i>
                                                <h4>完整性验证</h4>
                                            </div>
                                            <p>执行全面的数据完整性检查，确保系统数据关联正确</p>
                                            <el-button 
                                                type="success" 
                                                @click="runDataIntegrityValidation"
                                                :loading="dataValidationLoading"
                                                :disabled="maintenanceMode.enabled">
                                                <i class="fas fa-play"></i>
                                                运行验证
                                            </el-button>
                                            <div v-if="lastValidationResult" style="margin-top: 15px; padding: 10px; background: #f5f7fa; border-radius: 4px;">
                                                <p style="margin: 0; font-size: 12px; color: #666;">
                                                    上次验证: {{ formatDateTime(lastValidationResult.timestamp) }}
                                                </p>
                                                <p style="margin: 5px 0 0 0;">
                                                    <el-tag 
                                                        :type="lastValidationResult.validation_passed ? 'success' : 'danger'" 
                                                        size="mini">
                                                        {{ lastValidationResult.validation_passed ? '验证通过' : '验证失败' }}
                                                    </el-tag>
                                                    <span style="margin-left: 5px; font-size: 12px;">
                                                        错误: {{ lastValidationResult.summary.total_errors }}, 
                                                        警告: {{ lastValidationResult.summary.total_warnings }}
                                                    </span>
                                                </p>
                                            </div>
                                        </el-card>
                                    </el-col>
                                </el-row>
                            </div>
                        </el-card>
                    </div>

                    <!-- 学生管理 -->
                    <div v-show="activeMenu === 'students'" class="students-management">
                        <div class="page-header">
                            <h3>学生管理</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showStudentDialog('create')" icon="el-icon-plus">
                                    添加学生
                                </el-button>
                                <el-button @click="refreshStudents" icon="el-icon-refresh" :loading="studentsLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 搜索筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="studentsFilters" label-width="60px" inline class="single-line-form">
                                <el-form-item label="关键词">
                                    <el-input v-model="studentsFilters.keyword" placeholder="姓名、学号或邮箱" clearable style="width: 180px;"></el-input>
                                </el-form-item>
                                <el-form-item label="年级">
                                    <el-select v-model="studentsFilters.grade" placeholder="选择年级" clearable style="width: 120px;">
                                        <el-option label="2025级" value="2025"></el-option>
                                        <el-option label="2024级" value="2024"></el-option>
                                        <el-option label="2023级" value="2023"></el-option>
                                        <el-option label="2022级" value="2022"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="专业">
                                    <el-input v-model="studentsFilters.major" placeholder="专业名称" clearable style="width: 130px;"></el-input>
                                </el-form-item>
                                <el-form-item label="状态">
                                    <el-select v-model="studentsFilters.status" placeholder="学生状态" clearable style="width: 110px;">
                                        <el-option label="正常" value="active"></el-option>
                                        <el-option label="暂停" value="inactive"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchStudents">搜索</el-button>
                                    <el-button @click="resetStudentsFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 学生列表 -->
                        <el-card class="table-card">
                            <el-table :data="studentsList" v-loading="studentsLoading" style="width: 100%">
                                <el-table-column prop="student_id" label="学号" min-width="100" align="center"></el-table-column>
                                <el-table-column prop="real_name" label="姓名" min-width="100" align="center"></el-table-column>
                                <el-table-column prop="grade" label="年级" min-width="80" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="major" label="专业" min-width="120" align="center" show-overflow-tooltip class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="class_name" label="班级" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="email" label="邮箱" min-width="150" align="center" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="phone" label="联系电话" min-width="120" align="center"></el-table-column>
                                <el-table-column prop="credit_limit" label="学分上限" min-width="90" align="center"></el-table-column>
                                <el-table-column prop="status" label="状态" min-width="80" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="scope.row.status === 'active' ? 'success' : 'danger'">
                                            {{ scope.row.status === 'active' ? '正常' : '暂停' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="注册时间" min-width="140" align="center">
                                    <template slot-scope="scope">
                                        {{ formatDateTime(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="200" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewStudent(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="editStudent(scope.row)">编辑</el-button>
                                            <el-button size="mini" :type="scope.row.status === 'active' ? 'warning' : 'success'" 
                                                      @click="toggleStudentStatus(scope.row)">
                                                {{ scope.row.status === 'active' ? '暂停' : '启用' }}
                                            </el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleStudentsSizeChange"
                                    @current-change="handleStudentsCurrentChange"
                                    :current-page="studentsPagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="studentsPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="studentsPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 管理员管理 -->
                    <div v-show="activeMenu === 'admins'" class="admins-management">
                        <div class="page-header">
                            <h3>管理员管理</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showAdminDialog('create')" icon="el-icon-plus">
                                    添加管理员
                                </el-button>
                                <el-button @click="refreshAdmins" icon="el-icon-refresh" :loading="adminsLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 管理员列表 -->
                        <el-card class="table-card">
                            <el-table :data="adminsList" v-loading="adminsLoading" style="width: 100%">
                                <el-table-column prop="username" label="用户名" min-width="120" align="center"></el-table-column>
                                <el-table-column prop="real_name" label="真实姓名" min-width="100" align="center"></el-table-column>
                                <el-table-column prop="role" label="角色" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getAdminRoleColor(scope.row.role)">
                                            {{ getAdminRoleText(scope.row.role) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="email" label="邮箱" min-width="160" align="center" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="phone" label="联系电话" min-width="120" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="status" label="状态" min-width="80" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="scope.row.status === 'active' ? 'success' : 'danger'">
                                            {{ scope.row.status === 'active' ? '正常' : '禁用' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="last_login" label="最后登录" min-width="140" align="center" class-name="hide-on-mobile">
                                    <template slot-scope="scope">
                                        <div style="font-size: 12px;">
                                            {{ scope.row.last_login ? formatDateTime(scope.row.last_login) : '从未登录' }}
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="创建时间" min-width="140" align="center" class-name="hide-on-mobile">
                                    <template slot-scope="scope">
                                        <div style="font-size: 12px;">
                                            {{ formatDateTime(scope.row.created_at) }}
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="200" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewAdmin(scope.row)">详情</el-button>
                                            <el-button size="mini" type="primary" @click="editAdmin(scope.row)">编辑</el-button>
                                            <el-button size="mini" :type="scope.row.status === 'active' ? 'warning' : 'success'" 
                                                      @click="toggleAdminStatus(scope.row)"
                                                      :disabled="scope.row.id === currentUser.id">
                                                {{ scope.row.status === 'active' ? '禁用' : '启用' }}
                                            </el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleAdminsSizeChange"
                                    @current-change="handleAdminsCurrentChange"
                                    :current-page="adminsPagination.page"
                                    :page-sizes="[10, 20, 50]"
                                    :page-size="adminsPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="adminsPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 系统日志 -->
                    <div v-show="activeMenu === 'logs'" class="system-logs">
                        <div class="page-header">
                            <h3>系统日志</h3>
                            <div class="header-actions">
                                <el-button @click="refreshLogs" icon="el-icon-refresh" :loading="logsLoading">
                                    刷新数据
                                </el-button>
                            </div>
                        </div>

                        <!-- 日志筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="logsFilters" label-width="80px" inline class="single-line-form">
                                <el-form-item label="操作类型">
                                    <el-select v-model="logsFilters.operation_type" placeholder="选择操作类型" clearable style="width: 140px;">
                                        <el-option label="创建" value="create"></el-option>
                                        <el-option label="更新" value="update"></el-option>
                                        <el-option label="删除" value="delete"></el-option>
                                        <el-option label="登录" value="login"></el-option>
                                        <el-option label="登出" value="logout"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="操作模块">
                                    <el-select v-model="logsFilters.operation_module" placeholder="选择模块" clearable style="width: 140px;">
                                        <el-option label="用户管理" value="user_management"></el-option>
                                        <el-option label="课程管理" value="course_management"></el-option>
                                        <el-option label="选课管理" value="selection_management"></el-option>
                                        <el-option label="系统配置" value="system_config"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="时间范围">
                                    <el-date-picker
                                        v-model="logsFilters.dateRange"
                                        type="datetimerange"
                                        start-placeholder="开始时间"
                                        end-placeholder="结束时间"
                                        format="yyyy-MM-dd HH:mm:ss"
                                        value-format="yyyy-MM-dd HH:mm:ss"
                                        style="width: 300px;">
                                    </el-date-picker>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchLogs">查询</el-button>
                                    <el-button @click="resetLogsFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 日志列表 -->
                        <el-card class="table-card">
                            <el-table :data="logsList" v-loading="logsLoading" style="width: 100%">
                                <el-table-column prop="operation_type" label="操作类型" min-width="90" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getOperationTypeColor(scope.row.operation_type)">
                                            {{ scope.row.operation_type }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="operation_module" label="模块" min-width="100" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="operation_description" label="操作描述" min-width="180" align="center" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="admin_name" label="操作者" min-width="100" align="center"></el-table-column>
                                <el-table-column prop="ip_address" label="IP地址" min-width="110" align="center" class-name="hide-on-mobile"></el-table-column>
                                <el-table-column prop="result" label="结果" min-width="70" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="scope.row.result === 'success' ? 'success' : 'danger'">
                                            {{ scope.row.result === 'success' ? '成功' : '失败' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="操作时间" min-width="140" align="center">
                                    <template slot-scope="scope">
                                        <div style="font-size: 12px;">
                                            {{ formatDateTime(scope.row.created_at) }}
                                        </div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewLogDetail(scope.row)">详情</el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleLogsSizeChange"
                                    @current-change="handleLogsCurrentChange"
                                    :current-page="logsPagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="logsPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="logsPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 系统参数配置 -->
                    <div v-show="activeMenu === 'system-config'" class="system-config">
                        <div class="page-header">
                            <h3>系统参数配置</h3>
                            <div class="header-actions">
                                <el-button @click="refreshSystemConfigs" icon="el-icon-refresh">刷新</el-button>
                                <el-button type="primary" @click="showSystemConfigDialog('create')" icon="el-icon-plus">
                                    新建配置
                                </el-button>
                                <el-button @click="batchUpdateSystemConfigs" icon="el-icon-s-order" :disabled="!hasModifiedConfigs">
                                    批量保存
                                </el-button>
                            </div>
                        </div>

                        <!-- 筛选条件 -->
                        <el-card class="filter-card">
                            <el-form :inline="true" :model="systemConfigFilter" class="filter-form">
                                <el-form-item label="配置分类">
                                    <el-select v-model="systemConfigFilter.category" placeholder="全部分类" clearable @change="loadSystemConfigs">
                                        <el-option label="全部分类" value="all"></el-option>
                                        <el-option 
                                            v-for="cat in configCategories" 
                                            :key="cat.category" 
                                            :label="cat.category_name" 
                                            :value="cat.category">
                                        </el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="搜索">
                                    <el-input 
                                        v-model="systemConfigFilter.search" 
                                        placeholder="配置键或描述"
                                        @keyup.enter="loadSystemConfigs"
                                        clearable>
                                        <el-button slot="append" icon="el-icon-search" @click="loadSystemConfigs"></el-button>
                                    </el-input>
                                </el-form-item>
                                <el-form-item>
                                    <el-checkbox v-model="systemConfigFilter.onlyPublic" @change="loadSystemConfigs">
                                        只显示公开配置
                                    </el-checkbox>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 配置列表 -->
                        <el-card v-for="category in groupedConfigs" :key="category.category" class="config-category-card">
                            <div slot="header" class="category-header">
                                <span class="category-title">
                                    <i class="fas fa-folder"></i>
                                    {{ category.categoryName }} ({{ category.configs.length }})
                                </span>
                                <el-button size="mini" type="text" @click="toggleCategoryExpand(category.category)">
                                    <i :class="category.expanded ? 'el-icon-arrow-down' : 'el-icon-arrow-right'"></i>
                                </el-button>
                            </div>
                            
                            <div v-show="category.expanded" class="config-items">
                                <el-row :gutter="20" v-for="config in category.configs" :key="config.config_key" class="config-item">
                                    <el-col :span="6" class="config-key">
                                        <div class="key-info">
                                            <strong>{{ config.config_key }}</strong>
                                            <el-tag v-if="config.is_public" size="mini" type="info">公开</el-tag>
                                            <el-tag size="mini" :type="getConfigTypeColor(config.config_type)">
                                                {{ config.config_type }}
                                            </el-tag>
                                        </div>
                                        <div class="key-description">{{ config.description }}</div>
                                    </el-col>
                                    
                                    <el-col :span="12" class="config-value">
                                        <!-- 字符串类型 -->
                                        <el-input 
                                            v-if="config.config_type === 'string'" 
                                            v-model="config.config_value"
                                            @input="markConfigAsModified(config.config_key)"
                                            :placeholder="config.description">
                                        </el-input>
                                        
                                        <!-- 数字类型 -->
                                        <el-input-number 
                                            v-else-if="config.config_type === 'number'" 
                                            v-model.number="config.config_value"
                                            @change="markConfigAsModified(config.config_key)"
                                            :precision="0"
                                            style="width: 100%">
                                        </el-input-number>
                                        
                                        <!-- 布尔类型 -->
                                        <el-switch 
                                            v-else-if="config.config_type === 'boolean'" 
                                            v-model="config.config_value"
                                            @change="markConfigAsModified(config.config_key)"
                                            active-text="是"
                                            inactive-text="否"
                                            :active-value="true"
                                            :inactive-value="false">
                                        </el-switch>
                                        
                                        <!-- JSON类型 -->
                                        <el-input 
                                            v-else-if="config.config_type === 'json'" 
                                            v-model="config.config_value"
                                            @input="markConfigAsModified(config.config_key)"
                                            type="textarea"
                                            :rows="3"
                                            :placeholder="config.description">
                                        </el-input>
                                    </el-col>
                                    
                                    <el-col :span="6" class="config-actions">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="saveSystemConfig(config)" 
                                                      :loading="config.saving"
                                                      :disabled="!isConfigModified(config.config_key)">
                                                保存
                                            </el-button>
                                            <el-button size="mini" type="info" @click="resetSystemConfig(config)">
                                                重置
                                            </el-button>
                                            <el-dropdown @command="handleConfigAction" trigger="click">
                                                <el-button size="mini" type="text">
                                                    更多<i class="el-icon-arrow-down el-icon--right"></i>
                                                </el-button>
                                                <el-dropdown-menu slot="dropdown">
                                                    <el-dropdown-item :command="{action: 'edit', config: config}">编辑</el-dropdown-item>
                                                    <el-dropdown-item :command="{action: 'copy', config: config}">复制</el-dropdown-item>
                                                    <el-dropdown-item :command="{action: 'delete', config: config}" 
                                                                     :disabled="isSystemCriticalConfig(config.config_key)">
                                                        删除
                                                    </el-dropdown-item>
                                                </el-dropdown-menu>
                                            </el-dropdown>
                                        </div>
                                        
                                        <div class="config-meta">
                                            <div v-if="config.updated_by_name" class="updated-info">
                                                <small>最后更新：{{ config.updated_by_name }}</small>
                                            </div>
                                            <div v-if="config.updated_at" class="updated-time">
                                                <small>{{ formatDateTime(config.updated_at) }}</small>
                                            </div>
                                        </div>
                                    </el-col>
                                </el-row>
                            </div>
                        </el-card>

                        <!-- 加载状态 -->
                        <div v-if="systemConfigsLoading" class="loading-placeholder">
                            <el-icon class="is-loading"><i class="el-icon-loading"></i></el-icon>
                            <p>正在加载系统配置...</p>
                        </div>

                        <!-- 空状态 -->
                        <div v-else-if="!systemConfigs.length" class="empty-placeholder">
                            <i class="fas fa-cog"></i>
                            <p>暂无系统配置</p>
                            <el-button type="primary" @click="showSystemConfigDialog('create')">创建第一个配置</el-button>
                        </div>
                    </div>

                    <!-- 教师资质管理（已移除，集成到教师管理中） -->
                    <div v-show="false" class="teacher-qualifications-management">
                        <div class="page-header">
                            <h3>教师资质管理</h3>
                            <div class="header-actions">
                                <el-button type="primary" @click="showQualificationDialog('create')" icon="el-icon-plus">
                                    添加资质
                                </el-button>
                                <el-button @click="refreshQualifications" icon="el-icon-refresh" :loading="qualificationLoading">
                                    刷新数据
                                </el-button>
                                <el-button type="success" @click="exportQualifications" icon="el-icon-download">
                                    导出资质报告
                                </el-button>
                            </div>
                        </div>

                        <!-- 统计卡片 -->
                        <el-row :gutter="20" class="stats-row">
                            <el-col :span="6">
                                <el-card class="stat-card">
                                    <div class="stat-item">
                                        <div class="stat-value">{{ qualificationStats.total || 0 }}</div>
                                        <div class="stat-label">总资质数</div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card">
                                    <div class="stat-item">
                                        <div class="stat-value success">{{ qualificationStats.active || 0 }}</div>
                                        <div class="stat-label">有效资质</div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card">
                                    <div class="stat-item">
                                        <div class="stat-value warning">{{ qualificationStats.expiringSoon || 0 }}</div>
                                        <div class="stat-label">即将过期</div>
                                    </div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card">
                                    <div class="stat-item">
                                        <div class="stat-value info">{{ qualificationStats.pending || 0 }}</div>
                                        <div class="stat-label">待审核</div>
                                    </div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <!-- 搜索筛选 -->
                        <el-card class="filter-card" shadow="never">
                            <el-form :model="qualificationFilters" label-width="80px" inline class="single-line-form">
                                <el-form-item label="教师">
                                    <el-select v-model="qualificationFilters.teacher_id" placeholder="选择教师" clearable style="width: 160px;" filterable>
                                        <el-option
                                            v-for="teacher in teachersList"
                                            :key="teacher.id"
                                            :label="teacher.name + ' (' + teacher.employee_id + ')'"
                                            :value="teacher.id">
                                        </el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="体育类别">
                                    <el-select v-model="qualificationFilters.sport_category" placeholder="选择类别" clearable style="width: 140px;">
                                        <el-option label="篮球" value="篮球"></el-option>
                                        <el-option label="足球" value="足球"></el-option>
                                        <el-option label="网球" value="网球"></el-option>
                                        <el-option label="羽毛球" value="羽毛球"></el-option>
                                        <el-option label="游泳" value="游泳"></el-option>
                                        <el-option label="武术" value="武术"></el-option>
                                        <el-option label="健美操" value="健美操"></el-option>
                                        <el-option label="其他" value="其他"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="资质等级">
                                    <el-select v-model="qualificationFilters.qualification_level" placeholder="选择等级" clearable style="width: 120px;">
                                        <el-option label="国家级" value="国家级"></el-option>
                                        <el-option label="省级" value="省级"></el-option>
                                        <el-option label="市级" value="市级"></el-option>
                                        <el-option label="校级" value="校级"></el-option>
                                        <el-option label="其他" value="其他"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="状态">
                                    <el-select v-model="qualificationFilters.status" placeholder="选择状态" clearable style="width: 120px;">
                                        <el-option label="有效" value="active"></el-option>
                                        <el-option label="已过期" value="expired"></el-option>
                                        <el-option label="待审核" value="pending"></el-option>
                                        <el-option label="已拒绝" value="rejected"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="searchQualifications">搜索</el-button>
                                    <el-button @click="resetQualificationFilters">重置</el-button>
                                </el-form-item>
                            </el-form>
                        </el-card>

                        <!-- 资质列表 -->
                        <el-card class="table-card">
                            <el-table :data="qualificationList" v-loading="qualificationLoading" style="width: 100%" @selection-change="handleQualificationSelection">
                                <el-table-column type="selection" width="55" align="center"></el-table-column>
                                <el-table-column prop="teacher_name" label="教师姓名" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-link type="primary" @click="viewTeacherDetail(scope.row.teacher_id)">
                                            {{ scope.row.teacher_name }}
                                        </el-link>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="sport_category" label="体育类别" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag size="small">{{ scope.row.sport_category }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="qualification_level" label="资质等级" min-width="90" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getQualificationLevelType(scope.row.qualification_level)" size="small">
                                            {{ scope.row.qualification_level }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="certificate_name" label="证书名称" min-width="160" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="certificate_number" label="证书编号" min-width="130" align="center"></el-table-column>
                                <el-table-column prop="issuing_authority" label="颁发机构" min-width="140" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="issue_date" label="颁发日期" min-width="110" align="center">
                                    <template slot-scope="scope">
                                        {{ formatDate(scope.row.issue_date) }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="expire_date" label="过期日期" min-width="110" align="center">
                                    <template slot-scope="scope">
                                        <span v-if="scope.row.expire_date" :class="isExpiringSoon(scope.row.expire_date) ? 'text-warning' : ''">
                                            {{ formatDate(scope.row.expire_date) }}
                                        </span>
                                        <span v-else class="text-muted">长期有效</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="verified_status" label="审核状态" min-width="100" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getVerifiedStatusType(scope.row.verified_status)" size="small">
                                            {{ getVerifiedStatusText(scope.row.verified_status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="状态" min-width="90" align="center">
                                    <template slot-scope="scope">
                                        <el-tag :type="getQualificationStatusType(scope.row)" size="small">
                                            {{ getQualificationStatusText(scope.row) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" min-width="220" align="center" fixed="right">
                                    <template slot-scope="scope">
                                        <div class="action-buttons">
                                            <el-button size="mini" @click="viewQualification(scope.row)">查看</el-button>
                                            <el-button size="mini" type="primary" @click="editQualification(scope.row)">编辑</el-button>
                                            <el-button size="mini" type="success" @click="verifyQualification(scope.row)" 
                                                      v-if="scope.row.verified_status === 'pending'">审核</el-button>
                                            <el-button size="mini" type="danger" @click="deleteQualification(scope.row)">删除</el-button>
                                        </div>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <!-- 批量操作 -->
                            <div v-if="selectedQualifications.length > 0" class="batch-operations">
                                <el-alert
                                    :title="`已选择 ${selectedQualifications.length} 个资质`"
                                    type="info"
                                    show-icon
                                    :closable="false">
                                </el-alert>
                                <el-button type="success" @click="batchVerify('verified')">批量通过</el-button>
                                <el-button type="warning" @click="batchVerify('rejected')">批量拒绝</el-button>
                                <el-button type="danger" @click="batchDelete">批量删除</el-button>
                            </div>

                            <!-- 分页 -->
                            <div class="pagination-wrapper">
                                <el-pagination
                                    @size-change="handleQualificationSizeChange"
                                    @current-change="handleQualificationCurrentChange"
                                    :current-page="qualificationPagination.page"
                                    :page-sizes="[10, 20, 50, 100]"
                                    :page-size="qualificationPagination.limit"
                                    layout="total, sizes, prev, pager, next, jumper"
                                    :total="qualificationPagination.total">
                                </el-pagination>
                            </div>
                        </el-card>
                    </div>

                    <!-- 其他页面内容将在这里动态加载 -->
                    <div v-show="!['dashboard', 'selection-config', 'system-config', 'venues', 'teachers', 'real-time', 'statistics', 'popularity', 'performance', 'incidents', 'manual-adjust', 'maintenance', 'students', 'admins', 'logs'].includes(activeMenu)" class="dynamic-content">
                        <div class="page-header">
                            <h3>{{ getPageTitle(activeMenu) }}</h3>
                        </div>
                        <div class="content-placeholder">
                            <i class="fas fa-tools"></i>
                            <p>{{ getPageTitle(activeMenu) }}功能正在开发中...</p>
                            <p>请选择其他功能模块</p>
                        </div>
                    </div>
                </el-main>
            </el-container>
        </div>

        <!-- 学生管理对话框 -->
        <el-dialog 
            :title="studentDialog.title" 
            :visible.sync="studentDialog.visible" 
            width="600px" 
            :close-on-click-modal="false">
            <el-form :model="studentForm" :rules="studentRules" ref="studentForm" label-width="100px">
                <el-form-item label="学号" prop="student_id">
                    <el-input v-model="studentForm.student_id" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="用户名" prop="username">
                    <el-input v-model="studentForm.username" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="真实姓名" prop="real_name">
                    <el-input v-model="studentForm.real_name" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="年级" prop="grade">
                    <el-select v-model="studentForm.grade" placeholder="选择年级" :disabled="studentDialog.mode === 'view'" style="width: 100%;">
                        <el-option label="2025级" value="2025"></el-option>
                        <el-option label="2024级" value="2024"></el-option>
                        <el-option label="2023级" value="2023"></el-option>
                        <el-option label="2022级" value="2022"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="专业" prop="major">
                    <el-input v-model="studentForm.major" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="班级" prop="class_name">
                    <el-input v-model="studentForm.class_name" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="邮箱" prop="email">
                    <el-input v-model="studentForm.email" type="email" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="联系电话" prop="phone">
                    <el-input v-model="studentForm.phone" :disabled="studentDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="学分上限" prop="credit_limit">
                    <el-input-number v-model="studentForm.credit_limit" :min="0" :max="20" :disabled="studentDialog.mode === 'view'"></el-input-number>
                </el-form-item>
                <el-form-item label="密码" prop="password" v-if="studentDialog.mode === 'create'">
                    <el-input v-model="studentForm.password" type="password" placeholder="请输入密码"></el-input>
                </el-form-item>
                <el-form-item label="状态" prop="status" v-if="studentDialog.mode !== 'create'">
                    <el-select v-model="studentForm.status" :disabled="studentDialog.mode === 'view'" style="width: 100%;">
                        <el-option label="正常" value="active"></el-option>
                        <el-option label="暂停" value="inactive"></el-option>
                    </el-select>
                </el-form-item>
            </el-form>
            <div slot="footer" class="dialog-footer">
                <el-button @click="studentDialog.visible = false">取消</el-button>
                <el-button v-if="studentDialog.mode !== 'view'" type="primary" @click="saveStudent" :loading="studentDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 管理员管理对话框 -->
        <el-dialog 
            :title="adminDialog.title" 
            :visible.sync="adminDialog.visible" 
            width="600px" 
            :close-on-click-modal="false">
            <el-form :model="adminForm" :rules="adminRules" ref="adminForm" label-width="100px">
                <el-form-item label="用户名" prop="username">
                    <el-input v-model="adminForm.username" :disabled="adminDialog.mode === 'view' || adminDialog.mode === 'edit'"></el-input>
                </el-form-item>
                <el-form-item label="真实姓名" prop="real_name">
                    <el-input v-model="adminForm.real_name" :disabled="adminDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="角色" prop="role">
                    <el-select v-model="adminForm.role" placeholder="选择角色" :disabled="adminDialog.mode === 'view'" style="width: 100%;">
                        <el-option label="超级管理员" value="super_admin"></el-option>
                        <el-option label="管理员" value="admin"></el-option>
                        <el-option label="操作员" value="operator"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="邮箱" prop="email">
                    <el-input v-model="adminForm.email" type="email" :disabled="adminDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="联系电话" prop="phone">
                    <el-input v-model="adminForm.phone" :disabled="adminDialog.mode === 'view'"></el-input>
                </el-form-item>
                <el-form-item label="密码" prop="password" v-if="adminDialog.mode === 'create'">
                    <el-input v-model="adminForm.password" type="password" placeholder="请输入密码"></el-input>
                </el-form-item>
                <el-form-item label="状态" prop="status" v-if="adminDialog.mode !== 'create'">
                    <el-select v-model="adminForm.status" :disabled="adminDialog.mode === 'view'" style="width: 100%;">
                        <el-option label="正常" value="active"></el-option>
                        <el-option label="禁用" value="inactive"></el-option>
                    </el-select>
                </el-form-item>
            </el-form>
            <div slot="footer" class="dialog-footer">
                <el-button @click="adminDialog.visible = false">取消</el-button>
                <el-button v-if="adminDialog.mode !== 'view'" type="primary" @click="saveAdmin" :loading="adminDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 日志详情对话框 -->
        <el-dialog title="日志详情" :visible.sync="logDetailDialog.visible" width="800px">
            <div v-if="logDetailDialog.data">
                <el-descriptions title="" :column="2" border>
                    <el-descriptions-item label="操作类型">
                        <el-tag :type="getOperationTypeColor(logDetailDialog.data.operation_type)">
                            {{ logDetailDialog.data.operation_type }}
                        </el-tag>
                    </el-descriptions-item>
                    <el-descriptions-item label="操作模块">{{ logDetailDialog.data.operation_module }}</el-descriptions-item>
                    <el-descriptions-item label="操作者">{{ logDetailDialog.data.admin_name }}</el-descriptions-item>
                    <el-descriptions-item label="IP地址">{{ logDetailDialog.data.ip_address }}</el-descriptions-item>
                    <el-descriptions-item label="用户代理">{{ logDetailDialog.data.user_agent || '未知' }}</el-descriptions-item>
                    <el-descriptions-item label="操作结果">
                        <el-tag :type="logDetailDialog.data.result === 'success' ? 'success' : 'danger'">
                            {{ logDetailDialog.data.result === 'success' ? '成功' : '失败' }}
                        </el-tag>
                    </el-descriptions-item>
                    <el-descriptions-item label="操作时间" :span="2">
                        {{ formatDateTime(logDetailDialog.data.created_at) }}
                    </el-descriptions-item>
                    <el-descriptions-item label="操作描述" :span="2">
                        {{ logDetailDialog.data.operation_description }}
                    </el-descriptions-item>
                </el-descriptions>
                
                <div v-if="logDetailDialog.data.operation_details" style="margin-top: 20px;">
                    <h4>操作详情</h4>
                    <el-card class="detail-card">
                        <pre>{{ JSON.stringify(JSON.parse(logDetailDialog.data.operation_details), null, 2) }}</pre>
                    </el-card>
                </div>
                
                <div v-if="logDetailDialog.data.error_message" style="margin-top: 20px;">
                    <h4>错误信息</h4>
                    <el-alert :title="logDetailDialog.data.error_message" type="error" :closable="false"></el-alert>
                </div>
            </div>
            <div slot="footer" class="dialog-footer">
                <el-button @click="logDetailDialog.visible = false">关闭</el-button>
            </div>
        </el-dialog>

        <!-- 数据关联详情对话框 -->
        <el-dialog title="数据关联状态详情" :visible.sync="dataRelationDialog.visible" width="900px">
            <div v-if="dataRelationStatus">
                <!-- 总体状态 -->
                <div class="relation-overview" style="margin-bottom: 20px; padding: 15px; background: #f5f7fa; border-radius: 4px;">
                    <h4 style="margin-top: 0;">
                        <i class="fas fa-chart-pie"></i> 总体状态
                        <el-tag 
                            :type="getDataStatusType(dataRelationStatus.overall_status)" 
                            style="float: right;">
                            {{ getDataStatusText(dataRelationStatus.overall_status) }}
                        </el-tag>
                    </h4>
                    <el-row :gutter="20">
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">正常检查:</span>
                                <span class="stat-value" style="color: #67c23a;">{{ dataRelationStatus.summary.healthy }}</span>
                            </div>
                        </el-col>
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">警告:</span>
                                <span class="stat-value" style="color: #e6a23c;">{{ dataRelationStatus.summary.warnings }}</span>
                            </div>
                        </el-col>
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">错误:</span>
                                <span class="stat-value" style="color: #f56c6c;">{{ dataRelationStatus.summary.errors }}</span>
                            </div>
                        </el-col>
                    </el-row>
                </div>

                <!-- 详细检查结果 -->
                <div class="checks-detail">
                    <h4><i class="fas fa-list-ul"></i> 检查详情</h4>
                    <el-table :data="dataRelationStatus.checks" style="width: 100%">
                        <el-table-column prop="name" label="检查项目" width="200"></el-table-column>
                        <el-table-column prop="status" label="状态" width="100">
                            <template slot-scope="scope">
                                <el-tag :type="getDataStatusType(scope.row.status)" size="small">
                                    {{ getDataStatusText(scope.row.status) }}
                                </el-tag>
                            </template>
                        </el-table-column>
                        <el-table-column prop="details" label="详情" show-overflow-tooltip></el-table-column>
                        <el-table-column prop="severity" label="严重程度" width="100">
                            <template slot-scope="scope">
                                <el-tag 
                                    v-if="scope.row.severity !== 'none'"
                                    :type="getSeverityColor(scope.row.severity)" 
                                    size="mini">
                                    {{ getSeverityText(scope.row.severity) }}
                                </el-tag>
                                <span v-else style="color: #999;">-</span>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>

                <div style="margin-top: 20px; padding: 10px; background: #fafafa; border-radius: 4px; font-size: 12px; color: #666;">
                    <p style="margin: 0;"><i class="el-icon-time"></i> 最后更新时间: {{ formatDateTime(dataRelationStatus.last_updated) }}</p>
                </div>
            </div>
            <div slot="footer" class="dialog-footer">
                <el-button @click="loadDataRelationStatus">刷新数据</el-button>
                <el-button @click="dataRelationDialog.visible = false">关闭</el-button>
            </div>
        </el-dialog>

        <!-- 数据完整性验证结果对话框 -->
        <el-dialog title="数据完整性验证报告" :visible.sync="validationResultDialog.visible" width="1000px">
            <div v-if="validationResultDialog.data">
                <!-- 验证结果概览 -->
                <div class="validation-overview" style="margin-bottom: 20px; padding: 15px; background: #f5f7fa; border-radius: 4px;">
                    <h4 style="margin-top: 0;">
                        <i class="fas fa-clipboard-check"></i> 验证结果
                        <el-tag 
                            :type="validationResultDialog.data.validation_passed ? 'success' : 'danger'" 
                            style="float: right;">
                            {{ validationResultDialog.data.validation_passed ? '验证通过' : '验证失败' }}
                        </el-tag>
                    </h4>
                    <el-row :gutter="20">
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">信息项:</span>
                                <span class="stat-value" style="color: #909399;">{{ validationResultDialog.data.summary.total_info }}</span>
                            </div>
                        </el-col>
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">警告:</span>
                                <span class="stat-value" style="color: #e6a23c;">{{ validationResultDialog.data.summary.total_warnings }}</span>
                            </div>
                        </el-col>
                        <el-col :span="8">
                            <div class="stat-item">
                                <span class="stat-label">错误:</span>
                                <span class="stat-value" style="color: #f56c6c;">{{ validationResultDialog.data.summary.total_errors }}</span>
                            </div>
                        </el-col>
                    </el-row>
                </div>

                <!-- 验证详情 -->
                <el-tabs v-model="validationActiveTab" type="border-card">
                    <el-tab-pane label="信息" name="info" v-if="validationResultDialog.data.info.length > 0">
                        <div class="validation-items">
                            <div v-for="(item, index) in validationResultDialog.data.info" :key="index" class="validation-item info">
                                <i class="el-icon-info" style="color: #909399; margin-right: 5px;"></i>
                                {{ item }}
                            </div>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="警告" name="warnings" v-if="validationResultDialog.data.warnings.length > 0">
                        <div class="validation-items">
                            <div v-for="(item, index) in validationResultDialog.data.warnings" :key="index" class="validation-item warning">
                                <i class="el-icon-warning" style="color: #e6a23c; margin-right: 5px;"></i>
                                {{ item }}
                            </div>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="错误" name="errors" v-if="validationResultDialog.data.errors.length > 0">
                        <div class="validation-items">
                            <div v-for="(item, index) in validationResultDialog.data.errors" :key="index" class="validation-item error">
                                <i class="el-icon-error" style="color: #f56c6c; margin-right: 5px;"></i>
                                {{ item }}
                            </div>
                        </div>
                    </el-tab-pane>
                </el-tabs>

                <div style="margin-top: 20px; padding: 10px; background: #fafafa; border-radius: 4px; font-size: 12px; color: #666;">
                    <p style="margin: 0;"><i class="el-icon-time"></i> 验证时间: {{ formatDateTime(validationResultDialog.data.timestamp) }}</p>
                </div>
            </div>
            <div slot="footer" class="dialog-footer">
                <el-button @click="validationResultDialog.visible = false">关闭</el-button>
            </div>
        </el-dialog>

        <!-- 修改密码对话框 -->
        <el-dialog title="修改密码" :visible.sync="changePasswordVisible" width="400px">
            <el-form :model="passwordForm" :rules="passwordRules" ref="passwordForm">
                <el-form-item label="当前密码" prop="oldPassword">
                    <el-input v-model="passwordForm.oldPassword" type="password" show-password></el-input>
                </el-form-item>
                <el-form-item label="新密码" prop="newPassword">
                    <el-input v-model="passwordForm.newPassword" type="password" show-password></el-input>
                </el-form-item>
                <el-form-item label="确认密码" prop="confirmPassword">
                    <el-input v-model="passwordForm.confirmPassword" type="password" show-password></el-input>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="changePasswordVisible = false">取消</el-button>
                <el-button type="primary" @click="handleChangePassword" :loading="passwordLoading">确定</el-button>
            </div>
        </el-dialog>

        <!-- 选课配置对话框 -->
        <el-dialog :title="configDialog.mode === 'create' ? '新建选课配置' : configDialog.mode === 'edit' ? '编辑选课配置' : '选课配置详情'" 
                   :visible.sync="configDialog.visible" 
                   width="800px" 
                   :close-on-click-modal="false">
            <el-form :model="configForm" :rules="configRules" ref="configForm" label-width="120px">
                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="学年" prop="academic_year">
                            <el-select v-model="configForm.academic_year" placeholder="选择学年" :disabled="configDialog.mode === 'view'">
                                <el-option label="2025-2026" value="2025-2026"></el-option>
                                <el-option label="2024-2025" value="2024-2025"></el-option>
                                <el-option label="2023-2024" value="2023-2024"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="学期" prop="semester">
                            <el-select v-model="configForm.semester" placeholder="选择学期" :disabled="configDialog.mode === 'view'">
                                <el-option label="春季学期" value="2026春"></el-option>
                                <el-option label="秋季学期" value="2025秋"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="轮次" prop="round_number">
                            <el-input-number v-model="configForm.round_number" :min="1" :max="10" :disabled="configDialog.mode === 'view'"></el-input-number>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="轮次名称" prop="round_name">
                            <el-input v-model="configForm.round_name" placeholder="如：第一轮选课" :disabled="configDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-form-item label="选课方式" prop="selection_method">
                    <el-select v-model="configForm.selection_method" placeholder="选择选课方式" :disabled="configDialog.mode === 'view'">
                        <el-option label="先到先得" value="first_come"></el-option>
                        <el-option label="抽签" value="lottery"></el-option>
                        <el-option label="优先级" value="priority"></el-option>
                    </el-select>
                </el-form-item>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="开始时间" prop="start_time">
                            <el-date-picker
                                v-model="configForm.start_time"
                                type="datetime"
                                placeholder="选择开始时间"
                                format="yyyy-MM-dd HH:mm:ss"
                                value-format="yyyy-MM-dd HH:mm:ss"
                                :disabled="configDialog.mode === 'view'">
                            </el-date-picker>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="结束时间" prop="end_time">
                            <el-date-picker
                                v-model="configForm.end_time"
                                type="datetime"
                                placeholder="选择结束时间"
                                format="yyyy-MM-dd HH:mm:ss"
                                value-format="yyyy-MM-dd HH:mm:ss"
                                :disabled="configDialog.mode === 'view'">
                            </el-date-picker>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="最大学分" prop="max_credits">
                            <el-input-number v-model="configForm.max_credits" :min="1" :max="20" :disabled="configDialog.mode === 'view'"></el-input-number>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="最大课程数" prop="max_courses">
                            <el-input-number v-model="configForm.max_courses" :min="1" :max="10" :disabled="configDialog.mode === 'view'"></el-input-number>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="允许退课">
                            <el-switch v-model="configForm.allow_drop" :disabled="configDialog.mode === 'view'"></el-switch>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="允许改选">
                            <el-switch v-model="configForm.allow_change" :disabled="configDialog.mode === 'view'"></el-switch>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-form-item label="描述">
                    <el-input
                        v-model="configForm.description"
                        type="textarea"
                        :rows="3"
                        placeholder="请输入配置描述"
                        :disabled="configDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
            </el-form>

            <div slot="footer" v-if="configDialog.mode !== 'view'">
                <el-button @click="configDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveConfig" :loading="configDialog.loading">
                    {{ configDialog.mode === 'create' ? '创建' : '保存' }}
                </el-button>
            </div>
        </el-dialog>

        <!-- 复制配置对话框 -->
        <el-dialog title="复制选课配置" :visible.sync="copyConfigDialog.visible" width="400px">
            <el-form :model="copyConfigForm" :rules="copyConfigRules" ref="copyConfigForm" label-width="80px">
                <el-form-item label="学年" prop="academic_year">
                    <el-select v-model="copyConfigForm.academic_year" placeholder="选择学年">
                        <el-option label="2025-2026" value="2025-2026"></el-option>
                        <el-option label="2024-2025" value="2024-2025"></el-option>
                        <el-option label="2023-2024" value="2023-2024"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="学期" prop="semester">
                    <el-select v-model="copyConfigForm.semester" placeholder="选择学期">
                        <el-option label="春季学期" value="2026春"></el-option>
                        <el-option label="秋季学期" value="2025秋"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="轮次" prop="round_number">
                    <el-input-number v-model="copyConfigForm.round_number" :min="1" :max="10"></el-input-number>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="copyConfigDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="confirmCopyConfig" :loading="copyConfigDialog.loading">复制</el-button>
            </div>
        </el-dialog>

        <!-- 场地管理对话框 -->
        <el-dialog :title="venueDialog.mode === 'create' ? '新建场地' : venueDialog.mode === 'edit' ? '编辑场地' : '场地详情'"
                   :visible.sync="venueDialog.visible"
                   width="800px"
                   :close-on-click-modal="false">
            <el-form :model="venueForm" :rules="venueRules" ref="venueForm" label-width="100px">
                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="场地名称" prop="name">
                            <el-input v-model="venueForm.name" placeholder="请输入场地名称" :disabled="venueDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="场地类型" prop="type">
                            <el-select v-model="venueForm.type" placeholder="选择场地类型" :disabled="venueDialog.mode === 'view'">
                                <el-option label="室内" value="indoor"></el-option>
                                <el-option label="室外" value="outdoor"></el-option>
                                <el-option label="游泳馆" value="swimming"></el-option>
                                <el-option label="健身房" value="gym"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="位置" prop="location">
                            <el-input v-model="venueForm.location" placeholder="请输入场地位置" :disabled="venueDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="容量" prop="capacity">
                            <el-input-number v-model="venueForm.capacity" :min="1" :max="1000" :disabled="venueDialog.mode === 'view'"></el-input-number>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-form-item label="状态" prop="status">
                    <el-select v-model="venueForm.status" :disabled="venueDialog.mode === 'view'">
                        <el-option label="可用" value="available"></el-option>
                        <el-option label="维护中" value="maintenance"></el-option>
                        <el-option label="不可用" value="unavailable"></el-option>
                    </el-select>
                </el-form-item>

                <el-form-item label="设备描述">
                    <el-input
                        v-model="venueForm.equipment"
                        type="textarea"
                        :rows="3"
                        placeholder="请描述场地设备"
                        :disabled="venueDialog.mode === 'view'">
                    </el-input>
                </el-form-item>

                <el-form-item label="场地描述">
                    <el-input
                        v-model="venueForm.description"
                        type="textarea"
                        :rows="3"
                        placeholder="请输入场地描述"
                        :disabled="venueDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
            </el-form>

            <div slot="footer" v-if="venueDialog.mode !== 'view'">
                <el-button @click="venueDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveVenue" :loading="venueDialog.loading">
                    {{ venueDialog.mode === 'create' ? '创建' : '保存' }}
                </el-button>
            </div>
        </el-dialog>

        <!-- 场地时间表管理对话框 -->
        <el-dialog title="场地时间表管理"
                   :visible.sync="scheduleDialog.visible"
                   width="1200px"
                   :close-on-click-modal="false">
            <div v-if="scheduleDialog.venue" class="schedule-management">
                <!-- 场地信息 -->
                <el-card class="venue-info" shadow="never">
                    <div class="venue-header">
                        <h4>{{ scheduleDialog.venue.name }}</h4>
                        <el-tag :type="getVenueTypeColor(scheduleDialog.venue.type)">
                            {{ getVenueTypeText(scheduleDialog.venue.type) }}
                        </el-tag>
                        <span class="venue-details">{{ scheduleDialog.venue.location }} | 容量: {{ scheduleDialog.venue.capacity }}人</span>
                    </div>
                </el-card>

                <!-- 操作工具栏 -->
                <el-card class="schedule-toolbar" shadow="never">
                    <div class="toolbar-row">
                        <div class="left-actions">
                            <el-button type="primary" @click="showBatchSetDialog" icon="el-icon-setting">批量设置</el-button>
                            <el-button type="success" @click="showCopyScheduleDialog" icon="el-icon-copy-document">复制模板</el-button>
                            <el-button type="info" @click="viewUsageStatistics" icon="el-icon-data-analysis">使用统计</el-button>
                            <el-button type="warning" @click="clearSchedule" icon="el-icon-delete">清空时间表</el-button>
                        </div>
                        <div class="right-actions">
                            <el-button @click="refreshSchedule" icon="el-icon-refresh">刷新</el-button>
                        </div>
                    </div>
                </el-card>

                <!-- 时间表展示 -->
                <el-card class="schedule-display">
                    <div class="schedule-header">
                        <h4>每周开放时间表</h4>
                        <el-switch 
                            v-model="scheduleViewMode" 
                            active-text="列表视图" 
                            inactive-text="日历视图"
                            active-value="list"
                            inactive-value="calendar">
                        </el-switch>
                    </div>

                    <!-- 列表视图 -->
                    <div v-if="scheduleViewMode === 'list'" class="schedule-list">
                        <el-table :data="weeklyScheduleList" v-loading="scheduleLoading" style="width: 100%">
                            <el-table-column label="星期" width="80">
                                <template slot-scope="scope">
                                    <span>{{ getDayName(scope.row.dayOfWeek) }}</span>
                                </template>
                            </el-table-column>
                            <el-table-column label="开放时间段" min-width="200" align="center">
                                <template slot-scope="scope">
                                    <div class="time-slots">
                                        <el-tag 
                                            v-for="slot in scope.row.schedules" 
                                            :key="slot.id"
                                            :type="slot.is_available ? 'success' : 'danger'"
                                            size="small"
                                            class="time-slot-tag">
                                            {{ slot.start_time.substring(0, 5) }} - {{ slot.end_time.substring(0, 5) }}
                                            <i v-if="!slot.is_available" class="el-icon-warning-outline"></i>
                                        </el-tag>
                                        <el-tag v-if="scope.row.schedules.length === 0" type="info" size="small">未设置</el-tag>
                                    </div>
                                </template>
                            </el-table-column>
                            <el-table-column label="总时长" width="120">
                                <template slot-scope="scope">
                                    <span>{{ calculateDayTotalHours(scope.row.schedules) }}小时</span>
                                </template>
                            </el-table-column>
                            <el-table-column label="状态" width="100">
                                <template slot-scope="scope">
                                    <el-tag :type="scope.row.schedules.length > 0 ? 'success' : 'warning'" size="small">
                                        {{ scope.row.schedules.length > 0 ? '已配置' : '未配置' }}
                                    </el-tag>
                                </template>
                            </el-table-column>
                            <el-table-column label="操作" width="160">
                                <template slot-scope="scope">
                                    <div class="action-buttons">
                                        <el-button size="mini" type="primary" @click="editDaySchedule(scope.row)">编辑</el-button>
                                        <el-button size="mini" type="danger" @click="clearDaySchedule(scope.row)" v-if="scope.row.schedules.length > 0">清空</el-button>
                                    </div>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>

                    <!-- 日历视图 -->
                    <div v-else class="schedule-calendar">
                        <div class="calendar-grid">
                            <div class="time-header">
                                <div class="day-header"></div>
                                <div class="time-slot" v-for="hour in timeHours" :key="hour">
                                    {{ hour }}:00
                                </div>
                            </div>
                            <div v-for="day in 7" :key="day" class="day-column">
                                <div class="day-header">{{ getDayName(day) }}</div>
                                <div class="day-schedule">
                                    <div 
                                        v-for="slot in getDaySchedules(day)" 
                                        :key="slot.id"
                                        :class="['schedule-block', slot.is_available ? 'available' : 'unavailable']"
                                        :style="getScheduleBlockStyle(slot)"
                                        @click="editScheduleSlot(slot)"
                                        :title="slot.is_available ? `开放时间: ${slot.start_time.substring(0, 5)} - ${slot.end_time.substring(0, 5)}` : `维护时间: ${slot.start_time.substring(0, 5)} - ${slot.end_time.substring(0, 5)}\n原因: ${slot.maintenance_reason || '未说明'}`">
                                        <div class="time-range">{{ slot.start_time.substring(0, 5) }}-{{ slot.end_time.substring(0, 5) }}</div>
                                        <div v-if="slot.maintenance_reason" class="maintenance-note">{{ slot.maintenance_reason }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </el-card>
            </div>

            <div slot="footer">
                <el-button @click="scheduleDialog.visible = false">关闭</el-button>
            </div>
        </el-dialog>

        <!-- 批量设置时间表对话框 -->
        <el-dialog title="批量设置开放时间"
                   :visible.sync="batchSetDialog.visible"
                   width="600px"
                   :close-on-click-modal="false">
            <el-form :model="batchSetForm" :rules="batchSetRules" ref="batchSetForm" label-width="100px">
                <el-form-item label="设置模式" prop="scheduleType">
                    <el-radio-group v-model="batchSetForm.scheduleType">
                        <el-radio label="simple">简单模式</el-radio>
                        <el-radio label="detailed">详细模式</el-radio>
                    </el-radio-group>
                    <div class="form-hint">
                        <small>简单模式：每天设置一个连续时间段；详细模式：自定义多个时间段</small>
                    </div>
                </el-form-item>

                <el-form-item label="应用日期" prop="days">
                    <el-checkbox-group v-model="batchSetForm.days">
                        <el-checkbox :label="1">周一</el-checkbox>
                        <el-checkbox :label="2">周二</el-checkbox>
                        <el-checkbox :label="3">周三</el-checkbox>
                        <el-checkbox :label="4">周四</el-checkbox>
                        <el-checkbox :label="5">周五</el-checkbox>
                        <el-checkbox :label="6">周六</el-checkbox>
                        <el-checkbox :label="7">周日</el-checkbox>
                    </el-checkbox-group>
                    <div class="batch-actions">
                        <el-button size="mini" @click="selectWorkdays">工作日</el-button>
                        <el-button size="mini" @click="selectWeekend">周末</el-button>
                        <el-button size="mini" @click="selectAllDays">全选</el-button>
                    </div>
                </el-form-item>

                <!-- 简单模式 -->
                <div v-if="batchSetForm.scheduleType === 'simple'">
                    <el-form-item label="开始时间" prop="startTime">
                        <el-time-picker v-model="batchSetForm.startTime" format="HH:mm" value-format="HH:mm:ss" placeholder="选择开始时间"></el-time-picker>
                    </el-form-item>
                    <el-form-item label="结束时间" prop="endTime">
                        <el-time-picker v-model="batchSetForm.endTime" format="HH:mm" value-format="HH:mm:ss" placeholder="选择结束时间"></el-time-picker>
                    </el-form-item>
                </div>

                <!-- 详细模式 -->
                <div v-if="batchSetForm.scheduleType === 'detailed'">
                    <el-form-item label="时间段设置">
                        <div class="time-slots-editor">
                            <div v-for="(slot, index) in batchSetForm.timeSlots" :key="index" class="time-slot-row">
                                <el-time-picker v-model="slot.start_time" format="HH:mm" value-format="HH:mm:ss" placeholder="开始" style="width: 120px;"></el-time-picker>
                                <span>-</span>
                                <el-time-picker v-model="slot.end_time" format="HH:mm" value-format="HH:mm:ss" placeholder="结束" style="width: 120px;"></el-time-picker>
                                <el-switch v-model="slot.is_available" active-text="开放" inactive-text="关闭"></el-switch>
                                <el-input v-if="!slot.is_available" v-model="slot.maintenance_reason" placeholder="维护原因" style="width: 150px;"></el-input>
                                <el-button size="mini" type="danger" icon="el-icon-delete" @click="removeTimeSlot(index)" v-if="batchSetForm.timeSlots.length > 1"></el-button>
                            </div>
                            <el-button type="text" @click="addTimeSlot" icon="el-icon-plus">添加时间段</el-button>
                        </div>
                    </el-form-item>
                </div>
            </el-form>

            <div slot="footer">
                <el-button @click="batchSetDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="confirmBatchSet" :loading="batchSetDialog.loading">确定设置</el-button>
            </div>
        </el-dialog>

        <!-- 复制时间表模板对话框 -->
        <el-dialog title="复制时间表模板"
                   :visible.sync="copyScheduleDialog.visible"
                   width="500px"
                   :close-on-click-modal="false">
            <el-form :model="copyScheduleForm" ref="copyScheduleForm" label-width="100px">
                <el-form-item label="源场地">
                    <span>{{ scheduleDialog.venue ? scheduleDialog.venue.name : '' }}</span>
                </el-form-item>
                <el-form-item label="目标场地" prop="targetVenueIds">
                    <el-select v-model="copyScheduleForm.targetVenueIds" multiple placeholder="选择要应用的场地" style="width: 100%;">
                        <el-option 
                            v-for="venue in allVenues.filter(v => v.id !== scheduleDialog.venue.id)" 
                            :key="venue.id"
                            :label="`${venue.name} (${getVenueTypeText(venue.type)})`"
                            :value="venue.id">
                        </el-option>
                    </el-select>
                </el-form-item>
                <el-alert
                    title="注意：复制操作会覆盖目标场地的现有时间表设置"
                    type="warning"
                    :closable="false"
                    show-icon>
                </el-alert>
            </el-form>

            <div slot="footer">
                <el-button @click="copyScheduleDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="confirmCopySchedule" :loading="copyScheduleDialog.loading">确定复制</el-button>
            </div>
        </el-dialog>

        <!-- 单日时间表编辑对话框 -->
        <el-dialog :title="`编辑周${['', '一', '二', '三', '四', '五', '六', '日'][dayScheduleDialog.dayOfWeek]}时间表`"
                   :visible.sync="dayScheduleDialog.visible"
                   width="960px"
                   :close-on-click-modal="false"
                   class="day-schedule-dialog">
            <div v-if="dayScheduleDialog.venue" class="day-schedule-editor">
                <!-- 场地信息卡片 -->
                <div class="venue-info-card">
                    <div class="venue-info-left">
                        <i class="el-icon-office-building"></i>
                        <span class="venue-name">{{ dayScheduleDialog.venue.name }}</span>
                        <el-tag :type="getVenueTypeColor(dayScheduleDialog.venue.type)" size="small">
                            {{ getVenueTypeText(dayScheduleDialog.venue.type) }}
                        </el-tag>
                    </div>
                    <div class="venue-info-right">
                        <span class="edit-day-label">周{{ ['', '一', '二', '三', '四', '五', '六', '日'][dayScheduleDialog.dayOfWeek] }}</span>
                    </div>
                </div>

                <!-- 时间段管理区域 -->
                <div class="schedule-management">
                    <div class="management-header">
                        <div class="header-title">
                            <i class="el-icon-time"></i>
                            <span>开放时间段</span>
                        </div>
                        <el-button type="primary" size="small" icon="el-icon-plus" @click="addTimeSlot">
                            添加时间段
                        </el-button>
                    </div>

                    <div v-if="dayScheduleDialog.schedules.length > 0" class="time-slots-list">
                        <div v-for="(slot, index) in dayScheduleDialog.schedules" :key="index" class="time-slot-item">
                            <div class="slot-main-row">
                                <div class="slot-index">{{ index + 1 }}</div>
                                
                                <div class="slot-time-range">
                                    <div class="time-input-group">
                                        <label>开始时间</label>
                                        <el-time-picker
                                            v-model="slot.start_time"
                                            format="HH:mm"
                                            value-format="HH:mm:ss"
                                            placeholder="开始"
                                            :picker-options="{
                                                selectableRange: '00:00:00 - 23:59:59'
                                            }">
                                        </el-time-picker>
                                    </div>
                                    <div class="time-separator">至</div>
                                    <div class="time-input-group">
                                        <label>结束时间</label>
                                        <el-time-picker
                                            v-model="slot.end_time"
                                            format="HH:mm"
                                            value-format="HH:mm:ss"
                                            placeholder="结束"
                                            :picker-options="{
                                                selectableRange: '00:00:00 - 23:59:59'
                                            }">
                                        </el-time-picker>
                                    </div>
                                </div>
                                
                                <div class="slot-status">
                                    <label>状态</label>
                                    <el-switch
                                        v-model="slot.is_available"
                                        active-color="#67C23A"
                                        inactive-color="#F56C6C"
                                        active-text="开放"
                                        inactive-text="维护">
                                    </el-switch>
                                </div>
                                
                                <div class="slot-action">
                                    <el-button
                                        type="danger"
                                        icon="el-icon-delete"
                                        size="small"
                                        circle
                                        @click="removeTimeSlot(index)">
                                    </el-button>
                                </div>
                            </div>
                            
                            <div class="slot-reason-row" v-if="!slot.is_available">
                                <label>维护原因</label>
                                <el-input
                                    v-model="slot.maintenance_reason"
                                    placeholder="请输入场地维护的具体原因（如：设备检修、场地翻新、临时活动占用等）"
                                    size="small"
                                    clearable>
                                </el-input>
                            </div>
                        </div>
                    </div>

                    <div v-else class="no-data-card">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMyIDJDMTUuNDMxNSAyIDIgMTUuNDMxNSAyIDMyQzIgNDguNTY4NSAxNS40MzE1IDYyIDMyIDYyQzQ4LjU2ODUgNjIgNjIgNDguNTY4NSA2MiAzMkM2MiAxNS40MzE1IDQ4LjU2ODUgMiAzMiAyWiIgZmlsbD0iI0U2RjRGRiIvPgo8cGF0aCBkPSJNMzIgMjBWNDQiIHN0cm9rZT0iIzE4OTBGRiIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KPHBhdGggZD0iTTIwIDMySDQ0IiBzdHJva2U9IiMxODkwRkYiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+Cjwvc3ZnPg==" alt="no-data" style="width: 64px; opacity: 0.3;">
                        <p>当天暂无时间段设置</p>
                        <el-button type="primary" size="small" @click="addTimeSlot">立即添加</el-button>
                    </div>
                </div>

                <!-- 快速设置 -->
                <div class="quick-settings-card">
                    <div class="quick-settings-header">
                        <i class="el-icon-s-operation"></i>
                        <span>快速设置</span>
                    </div>
                    <div class="quick-settings-buttons">
                        <el-button plain size="small" @click="setQuickSchedule('morning')">
                            <i class="el-icon-sunrise"></i> 上午
                        </el-button>
                        <el-button plain size="small" @click="setQuickSchedule('afternoon')">
                            <i class="el-icon-sunny"></i> 下午
                        </el-button>
                        <el-button plain size="small" @click="setQuickSchedule('evening')">
                            <i class="el-icon-moon"></i> 晚间
                        </el-button>
                        <el-button plain size="small" @click="setQuickSchedule('fullday')">
                            <i class="el-icon-timer"></i> 全天
                        </el-button>
                    </div>
                </div>
            </div>

            <div slot="footer" class="dialog-footer">
                <el-button @click="dayScheduleDialog.visible = false">取 消</el-button>
                <el-button type="primary" @click="saveDaySchedule" :loading="dayScheduleDialog.loading">保 存</el-button>
            </div>
        </el-dialog>

        <!-- 使用统计对话框 -->
        <el-dialog title="场地使用统计"
                   :visible.sync="usageStatsDialog.visible"
                   width="900px"
                   class="usage-stats-dialog">
            <div v-if="usageStats" class="usage-statistics">
                <el-row :gutter="20" class="stats-overview">
                    <el-col :span="6">
                        <div class="usage-stat-card gradient-blue">
                            <div class="stat-icon-wrapper">
                                <i class="el-icon-s-grid stat-icon"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number">{{ usageStats.totalCourses }}</div>
                                <div class="stat-label">安排课程</div>
                            </div>
                        </div>
                    </el-col>
                    <el-col :span="6">
                        <div class="usage-stat-card gradient-green">
                            <div class="stat-icon-wrapper">
                                <i class="el-icon-time stat-icon"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number">{{ usageStats.totalSchedules }}</div>
                                <div class="stat-label">开放时段</div>
                            </div>
                        </div>
                    </el-col>
                    <el-col :span="6">
                        <div class="usage-stat-card gradient-orange">
                            <div class="stat-icon-wrapper">
                                <i class="el-icon-data-line stat-icon"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number">{{ calculateWeeklyUsageRate() }}%</div>
                                <div class="stat-label">平均使用率</div>
                            </div>
                        </div>
                    </el-col>
                    <el-col :span="6">
                        <div class="usage-stat-card gradient-purple">
                            <div class="stat-icon-wrapper">
                                <i class="el-icon-user stat-icon"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number">{{ usageStats.venue.capacity }}</div>
                                <div class="stat-label">场地容量</div>
                            </div>
                        </div>
                    </el-col>
                </el-row>

                <div class="usage-table-wrapper">
                    <h4 class="table-title"><i class="el-icon-data-analysis"></i> 每周详细统计</h4>
                    <el-table :data="usageStatsTableData" style="width: 100%;" class="usage-stats-table">
                        <el-table-column label="星期" width="80" align="center">
                        <template slot-scope="scope">
                            {{ getDayName(scope.row.dayOfWeek) }}
                        </template>
                        </el-table-column>
                        <el-table-column label="开放时长" width="120" align="center">
                        <template slot-scope="scope">
                            {{ (scope.row.totalAvailableMinutes / 60).toFixed(1) }}小时
                        </template>
                        </el-table-column>
                        <el-table-column label="已使用时长" width="120" align="center">
                        <template slot-scope="scope">
                            {{ (scope.row.totalUsedMinutes / 60).toFixed(1) }}小时
                        </template>
                        </el-table-column>
                        <el-table-column label="使用率" width="120" align="center">
                        <template slot-scope="scope">
                            <el-tag :type="getUsageRateColor(scope.row.usageRate)">
                                {{ scope.row.usageRate }}%
                            </el-tag>
                        </template>
                        </el-table-column>
                        <el-table-column label="安排课程" min-width="260">
                        <template slot-scope="scope">
                            <div v-if="scope.row.courses && scope.row.courses.length > 0" class="course-tags">
                                <el-tag v-for="course in scope.row.courses" :key="course.id" size="small" type="info">
                                    {{ course.name }}
                                </el-tag>
                            </div>
                            <el-tag v-else type="info" size="small">暂无课程</el-tag>
                        </template>
                        </el-table-column>
                    </el-table>
                </div>
            </div>
        </el-dialog>

        <!-- 教师管理对话框 -->
        <el-dialog :title="teacherDialog.mode === 'create' ? '新建教师' : teacherDialog.mode === 'edit' ? '编辑教师' : '教师详情'"
                   :visible.sync="teacherDialog.visible"
                   width="800px"
                   :close-on-click-modal="false">
            <el-form :model="teacherForm" :rules="teacherRules" ref="teacherForm" label-width="100px">
                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="教师姓名" prop="name">
                            <el-input v-model="teacherForm.name" placeholder="请输入教师姓名" :disabled="teacherDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="工号" prop="employee_id">
                            <el-input v-model="teacherForm.employee_id" placeholder="请输入工号" :disabled="teacherDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="职称" prop="title">
                            <el-select v-model="teacherForm.title" placeholder="选择职称" :disabled="teacherDialog.mode === 'view'">
                                <el-option label="教授" value="教授"></el-option>
                                <el-option label="副教授" value="副教授"></el-option>
                                <el-option label="讲师" value="讲师"></el-option>
                                <el-option label="助教" value="助教"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="部门" prop="department">
                            <el-select v-model="teacherForm.department" placeholder="选择部门" :disabled="teacherDialog.mode === 'view'">
                                <el-option label="体育学院" value="体育学院"></el-option>
                                <el-option label="教务处" value="教务处"></el-option>
                                <el-option label="学生处" value="学生处"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="联系电话" prop="phone">
                            <el-input v-model="teacherForm.phone" placeholder="请输入联系电话" :disabled="teacherDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="邮箱" prop="email">
                            <el-input v-model="teacherForm.email" placeholder="请输入邮箱" :disabled="teacherDialog.mode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-form-item label="状态" prop="status">
                    <el-select v-model="teacherForm.status" :disabled="teacherDialog.mode === 'view'">
                        <el-option label="在职" value="active"></el-option>
                        <el-option label="离职" value="inactive"></el-option>
                        <el-option label="暂停" value="suspended"></el-option>
                    </el-select>
                </el-form-item>

                <el-form-item label="专业特长">
                    <el-input
                        v-model="teacherForm.specialties"
                        type="textarea"
                        :rows="3"
                        placeholder="请描述教师的专业特长"
                        :disabled="teacherDialog.mode === 'view'">
                    </el-input>
                </el-form-item>

                <el-form-item label="个人简介">
                    <el-input
                        v-model="teacherForm.bio"
                        type="textarea"
                        :rows="3"
                        placeholder="请输入教师个人简介"
                        :disabled="teacherDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
            </el-form>

            <div slot="footer" v-if="teacherDialog.mode !== 'view'">
                <el-button @click="teacherDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveTeacher" :loading="teacherDialog.loading">
                    {{ teacherDialog.mode === 'create' ? '创建' : '保存' }}
                </el-button>
            </div>
        </el-dialog>

        <!-- 教师资质管理对话框 -->
        <el-dialog :title="qualificationDialogTitle"
                   :visible.sync="qualificationDialog.visible"
                   width="1200px"
                   :close-on-click-modal="false"
                   @close="handleQualificationDialogClose">
            <!-- 资质管理主界面 -->
            <div v-if="!qualificationDialog.showForm">
                <!-- 教师信息展示 -->
                <el-card class="teacher-info-card" shadow="never">
                    <div class="teacher-info">
                        <el-row>
                            <el-col :span="6">
                                <span class="info-label">教师姓名：</span>
                                <span class="info-value">{{ qualificationDialog.teacher.name }}</span>
                            </el-col>
                            <el-col :span="6">
                                <span class="info-label">工号：</span>
                                <span class="info-value">{{ qualificationDialog.teacher.employee_id }}</span>
                            </el-col>
                            <el-col :span="6">
                                <span class="info-label">部门：</span>
                                <span class="info-value">{{ qualificationDialog.teacher.department }}</span>
                            </el-col>
                            <el-col :span="6">
                                <span class="info-label">职称：</span>
                                <span class="info-value">{{ qualificationDialog.teacher.title }}</span>
                            </el-col>
                        </el-row>
                    </div>
                </el-card>

                <!-- 资质统计 -->
                <el-card class="qualification-stats" shadow="never">
                    <el-row :gutter="20">
                        <el-col :span="6">
                            <div class="stat-item">
                                <div class="stat-value">{{ qualificationStatistics.total }}</div>
                                <div class="stat-label">总资质数</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-item">
                                <div class="stat-value success">{{ qualificationStatistics.active }}</div>
                                <div class="stat-label">有效资质</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-item">
                                <div class="stat-value warning">{{ qualificationStatistics.expired }}</div>
                                <div class="stat-label">已过期</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-item">
                                <div class="stat-value info">{{ qualificationStatistics.inactive }}</div>
                                <div class="stat-label">未激活</div>
                            </div>
                        </el-col>
                    </el-row>
                </el-card>

                <!-- 操作按钮 -->
                <div class="qualification-actions">
                    <el-button type="primary" icon="el-icon-plus" @click="showQualificationForm('create')">添加资质</el-button>
                    <el-button icon="el-icon-refresh" @click="refreshQualifications">刷新</el-button>
                </div>

                <!-- 资质列表 -->
                <el-table 
                    :data="qualificationList" 
                    v-loading="qualificationLoading" 
                    class="qualification-table"
                    border
                    style="width: 100%">
                    <el-table-column type="index" label="序号" width="55" align="center"></el-table-column>
                    <el-table-column prop="sport_category" label="体育类别" width="90" align="center"></el-table-column>
                    <el-table-column prop="qualification_level" label="资质等级" width="80" align="center"></el-table-column>
                    <el-table-column prop="certificate_name" label="证书名称" min-width="200" class-name="certificate-name-col">
                        <template slot-scope="scope">
                            <div class="certificate-name-text">{{ scope.row.certificate_name }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="certificate_number" label="证书编号" width="140" align="center"></el-table-column>
                    <el-table-column prop="issuing_authority" label="颁发机构" width="115" align="center" show-overflow-tooltip></el-table-column>
                    <el-table-column prop="issue_date" label="颁发日期" width="105" align="center">
                        <template slot-scope="scope">
                            {{ formatDate(scope.row.issue_date) }}
                        </template>
                    </el-table-column>
                    <el-table-column prop="expire_date" label="过期日期" width="105" align="center">
                        <template slot-scope="scope">
                            <span :class="{'expired-date': scope.row.expire_date && new Date(scope.row.expire_date) < new Date()}">
                                {{ scope.row.expire_date ? formatDate(scope.row.expire_date) : '长期' }}
                            </span>
                        </template>
                    </el-table-column>
                    <el-table-column label="状态" width="70" align="center">
                        <template slot-scope="scope">
                            <span :class="getQualificationStatusClass(scope.row)">
                                {{ getQualificationStatusText(scope.row) }}
                            </span>
                        </template>
                    </el-table-column>
                    <el-table-column label="操作" width="200" align="center">
                        <template slot-scope="scope">
                            <el-button size="mini" @click="viewQualification(scope.row)">查看</el-button>
                            <el-button size="mini" type="primary" @click="editQualification(scope.row)">编辑</el-button>
                            <el-button size="mini" type="danger" @click="deleteQualification(scope.row)">删除</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </div>

            <!-- 资质表单 -->
            <el-form v-else :model="qualificationForm" :rules="qualificationRules" ref="qualificationForm" label-width="120px">
                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="体育类别" prop="sport_category">
                            <el-select v-model="qualificationForm.sport_category" placeholder="选择体育类别" :disabled="qualificationDialog.formMode === 'view'">
                                <el-option label="篮球" value="篮球"></el-option>
                                <el-option label="足球" value="足球"></el-option>
                                <el-option label="网球" value="网球"></el-option>
                                <el-option label="羽毛球" value="羽毛球"></el-option>
                                <el-option label="乒乓球" value="乒乓球"></el-option>
                                <el-option label="游泳" value="游泳"></el-option>
                                <el-option label="武术" value="武术"></el-option>
                                <el-option label="健美操" value="健美操"></el-option>
                                <el-option label="瑜伽" value="瑜伽"></el-option>
                                <el-option label="田径" value="田径"></el-option>
                                <el-option label="其他" value="其他"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="资质等级" prop="qualification_level">
                            <el-select v-model="qualificationForm.qualification_level" placeholder="选择资质等级" :disabled="qualificationDialog.formMode === 'view'">
                                <el-option label="国家级" value="国家级"></el-option>
                                <el-option label="省级" value="省级"></el-option>
                                <el-option label="市级" value="市级"></el-option>
                                <el-option label="校级" value="校级"></el-option>
                                <el-option label="其他" value="其他"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="证书名称" prop="certificate_name">
                            <el-input v-model="qualificationForm.certificate_name" placeholder="请输入证书名称" :disabled="qualificationDialog.formMode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="证书编号" prop="certificate_number">
                            <el-input v-model="qualificationForm.certificate_number" placeholder="请输入证书编号" :disabled="qualificationDialog.formMode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="颁发机构" prop="issuing_authority">
                            <el-input v-model="qualificationForm.issuing_authority" placeholder="请输入颁发机构" :disabled="qualificationDialog.formMode === 'view'"></el-input>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="颁发日期" prop="issue_date">
                            <el-date-picker
                                v-model="qualificationForm.issue_date"
                                type="date"
                                placeholder="选择颁发日期"
                                value-format="yyyy-MM-dd"
                                :disabled="qualificationDialog.formMode === 'view'"
                                style="width: 100%">
                            </el-date-picker>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-row :gutter="20">
                    <el-col :span="12">
                        <el-form-item label="过期日期" prop="expire_date">
                            <el-date-picker
                                v-model="qualificationForm.expire_date"
                                type="date"
                                placeholder="选择过期日期（留空表示长期有效）"
                                value-format="yyyy-MM-dd"
                                :disabled="qualificationDialog.formMode === 'view'"
                                style="width: 100%">
                            </el-date-picker>
                        </el-form-item>
                    </el-col>
                    <el-col :span="12">
                        <el-form-item label="是否激活">
                            <el-switch
                                v-model="qualificationForm.is_active"
                                :disabled="qualificationDialog.formMode === 'view'"
                                active-text="激活"
                                inactive-text="未激活">
                            </el-switch>
                        </el-form-item>
                    </el-col>
                </el-row>

                <el-form-item label="资质描述">
                    <el-input
                        v-model="qualificationForm.description"
                        type="textarea"
                        :rows="3"
                        placeholder="请输入资质描述"
                        :disabled="qualificationDialog.formMode === 'view'">
                    </el-input>
                </el-form-item>

                <el-form-item label="附件URL">
                    <el-input v-model="qualificationForm.attachment_url" placeholder="请输入附件URL（可选）" :disabled="qualificationDialog.formMode === 'view'"></el-input>
                </el-form-item>

                <div v-if="qualificationDialog.formMode !== 'create'" class="form-footer-info">
                    <el-row>
                        <el-col :span="12">
                            <span class="info-label">创建时间：</span>
                            <span class="info-value">{{ formatDateTime(qualificationForm.created_at) }}</span>
                        </el-col>
                        <el-col :span="12">
                            <span class="info-label">更新时间：</span>
                            <span class="info-value">{{ formatDateTime(qualificationForm.updated_at) }}</span>
                        </el-col>
                    </el-row>
                </div>
            </el-form>

            <div slot="footer">
                <el-button v-if="qualificationDialog.showForm" @click="cancelQualificationForm">
                    {{ qualificationDialog.formMode === 'view' ? '返回' : '取消' }}
                </el-button>
                <el-button v-if="qualificationDialog.showForm && qualificationDialog.formMode !== 'view'" 
                          type="primary" 
                          @click="saveQualification" 
                          :loading="qualificationDialog.loading">
                    {{ qualificationDialog.formMode === 'create' ? '创建' : '保存' }}
                </el-button>
                <el-button v-if="!qualificationDialog.showForm" @click="qualificationDialog.visible = false">关闭</el-button>
            </div>
        </el-dialog>

        <!-- 系统配置对话框 -->
        <el-dialog :title="systemConfigDialog.mode === 'create' ? '新建系统配置' : systemConfigDialog.mode === 'edit' ? '编辑系统配置' : '系统配置详情'"
                   :visible.sync="systemConfigDialog.visible"
                   width="600px"
                   :close-on-click-modal="false">
            <el-form :model="systemConfigForm" :rules="systemConfigRules" ref="systemConfigForm" label-width="100px">
                <el-form-item label="配置键" prop="config_key">
                    <el-input v-model="systemConfigForm.config_key" 
                             placeholder="请输入配置键名（英文，如：system_name）"
                             :disabled="systemConfigDialog.mode === 'edit' || systemConfigDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
                
                <el-form-item label="配置类型" prop="config_type">
                    <el-select v-model="systemConfigForm.config_type" 
                              placeholder="选择配置类型"
                              :disabled="systemConfigDialog.mode === 'view' || systemConfigDialog.mode === 'edit'"
                              @change="onConfigTypeChange">
                        <el-option label="字符串" value="string"></el-option>
                        <el-option label="数字" value="number"></el-option>
                        <el-option label="布尔值" value="boolean"></el-option>
                        <el-option label="JSON对象" value="json"></el-option>
                    </el-select>
                </el-form-item>
                
                <el-form-item label="配置分类" prop="category">
                    <el-select v-model="systemConfigForm.category" 
                              placeholder="选择配置分类"
                              :disabled="systemConfigDialog.mode === 'view'">
                        <el-option label="系统基本" value="general"></el-option>
                        <el-option label="选课管理" value="selection"></el-option>
                        <el-option label="安全设置" value="security"></el-option>
                        <el-option label="消息通知" value="notification"></el-option>
                        <el-option label="系统限制" value="limitation"></el-option>
                        <el-option label="外观设置" value="appearance"></el-option>
                    </el-select>
                </el-form-item>
                
                <el-form-item label="配置值" prop="config_value">
                    <!-- 字符串类型 -->
                    <el-input v-if="systemConfigForm.config_type === 'string'" 
                             v-model="systemConfigForm.config_value"
                             placeholder="请输入配置值"
                             :disabled="systemConfigDialog.mode === 'view'">
                    </el-input>
                    
                    <!-- 数字类型 -->
                    <el-input-number v-else-if="systemConfigForm.config_type === 'number'" 
                                    v-model="systemConfigForm.config_value"
                                    :precision="0"
                                    :disabled="systemConfigDialog.mode === 'view'"
                                    style="width: 100%">
                    </el-input-number>
                    
                    <!-- 布尔类型 -->
                    <el-switch v-else-if="systemConfigForm.config_type === 'boolean'" 
                              v-model="systemConfigForm.config_value"
                              :disabled="systemConfigDialog.mode === 'view'"
                              active-text="是"
                              inactive-text="否"
                              :active-value="'true'"
                              :inactive-value="'false'">
                    </el-switch>
                    
                    <!-- JSON类型 -->
                    <el-input v-else-if="systemConfigForm.config_type === 'json'" 
                             v-model="systemConfigForm.config_value"
                             type="textarea"
                             :rows="4"
                             placeholder="请输入JSON格式的配置值"
                             :disabled="systemConfigDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
                
                <el-form-item label="配置描述" prop="description">
                    <el-input v-model="systemConfigForm.description" 
                             type="textarea"
                             :rows="2"
                             placeholder="请输入配置描述"
                             :disabled="systemConfigDialog.mode === 'view'">
                    </el-input>
                </el-form-item>
                
                <el-form-item label="是否公开">
                    <el-switch v-model="systemConfigForm.is_public"
                              :disabled="systemConfigDialog.mode === 'view'"
                              active-text="公开"
                              inactive-text="私有">
                    </el-switch>
                    <small class="form-tip">公开配置可被前端访问</small>
                </el-form-item>
            </el-form>
            
            <div slot="footer" class="dialog-footer" v-if="systemConfigDialog.mode !== 'view'">
                <el-button @click="systemConfigDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveSystemConfigFromDialog" :loading="systemConfigDialog.loading">
                    {{ systemConfigDialog.mode === 'create' ? '创建' : '保存' }}
                </el-button>
            </div>
        </el-dialog>
    </div>

    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    
    <!-- ElementUI JS -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    
    <!-- Axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    
    <!-- 自定义JS -->
    <script src="/js/admin.js"></script>
</body>
</html>
